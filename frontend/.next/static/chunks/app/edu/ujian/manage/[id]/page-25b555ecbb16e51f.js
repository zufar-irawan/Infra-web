(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[687],{6132:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(71847).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},35230:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>j});var t=s(95155),n=s(12115),l=s(20063),r=s(1026),i=s(95125),o=s(71360),c=s(46826),d=s(6132),u=s(35299),x=s(46046),m=s(60230),p=s(52619),g=s.n(p);let h=e=>i.A.get(e).then(e=>e.data),y=()=>({type:"pg",question_text:"",points:10,options:[{option_text:"",is_correct:!0},{option_text:"",is_correct:!1},{option_text:"",is_correct:!1},{option_text:"",is_correct:!1}]});function f(e){let{questionIndex:a,options:s,onChange:n}=e,l=(e,a)=>{let t=s.map((s,t)=>t===e?{...s,...a}:s);a.is_correct?n(t.map((a,s)=>({...a,is_correct:s===e}))):n(t)};return(0,t.jsxs)("div",{className:"space-y-2",children:[s.map((e,r)=>(0,t.jsxs)("div",{className:"flex flex-col gap-2 rounded-lg border px-3 py-2 text-sm transition ".concat(e.is_correct?"border-emerald-400 bg-emerald-50":"border-gray-200"),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"radio",checked:e.is_correct,onChange:()=>l(r,{is_correct:!0}),className:"h-4 w-4 text-emerald-500"}),(0,t.jsx)("span",{className:"text-xs uppercase tracking-wide text-gray-400",children:e.is_correct?"Jawaban Benar":"Pilihan ".concat(r+1)})]}),(0,t.jsx)("textarea",{value:e.option_text,onChange:e=>l(r,{option_text:e.target.value}),className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-orange-500 focus:outline-none focus:ring-2 focus:ring-orange-200",placeholder:"Tulis pilihan jawaban ".concat(r+1)}),s.length>2&&(0,t.jsxs)("button",{type:"button",onClick:()=>(e=>{if(s.length<=2)return;let a=s.filter((a,s)=>s!==e);a.some(e=>e.is_correct)||(a[0]={...a[0],is_correct:!0}),n(a)})(r),className:"inline-flex items-center gap-1 text-xs text-red-500 hover:text-red-400",children:[(0,t.jsx)(o.A,{className:"h-3 w-3"}),"Hapus pilihan"]})]},"".concat(a,"-").concat(r))),(0,t.jsxs)("button",{type:"button",onClick:()=>{n([...s,{option_text:"",is_correct:0===s.length}])},className:"inline-flex items-center gap-2 text-xs text-orange-500 hover:text-orange-400",children:[(0,t.jsx)(c.A,{className:"h-4 w-4"}),"Tambah pilihan"]})]})}function b(e){var a,s,n;let{question:l,onChange:r,onRemove:i,index:c}=e;return(0,t.jsxs)("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm space-y-4",children:[(0,t.jsxs)("header",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-orange-100 text-sm font-semibold text-orange-600",children:l.points}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-wide text-gray-400",children:"pg"===l.type?"Pilihan Ganda":"Essay"}),(0,t.jsx)("input",{value:l.question_text,onChange:e=>r({...l,question_text:e.target.value}),placeholder:"Tulis pertanyaan di sini",className:"w-full max-w-xl border-none text-lg font-semibold text-gray-800 focus:outline-none focus:ring-0"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("select",{value:l.type,onChange:e=>r({...l,type:e.target.value}),className:"rounded-lg border border-gray-200 px-3 py-2 text-xs text-gray-600 focus:border-orange-500 focus:outline-none focus:ring-2 focus:ring-orange-200",children:[(0,t.jsx)("option",{value:"pg",children:"Pilihan Ganda"}),(0,t.jsx)("option",{value:"essay",children:"Essay"})]}),(0,t.jsx)("input",{type:"number",min:1,value:l.points,onChange:e=>r({...l,points:Number(e.target.value)}),className:"w-20 rounded-lg border border-gray-200 px-3 py-2 text-xs text-gray-600 focus:border-orange-500 focus:outline-none focus:ring-2 focus:ring-orange-200"}),(0,t.jsxs)("button",{type:"button",onClick:i,className:"inline-flex items-center gap-1 text-xs text-red-500 hover:text-red-400",children:[(0,t.jsx)(o.A,{className:"h-4 w-4"}),"Hapus soal"]})]})]}),"pg"===l.type?(0,t.jsx)(f,{questionIndex:c,options:l.options,onChange:e=>r({...l,options:e})}):(0,t.jsx)("textarea",{value:null!=(n=null==(s=l.options)||null==(a=s[0])?void 0:a.option_text)?n:"",onChange:e=>r({...l,options:[{option_text:e.target.value,is_correct:!0}]}),className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-orange-500 focus:outline-none focus:ring-2 focus:ring-orange-200",placeholder:"Panduan penilaian essay..."})]})}function j(){var e,a;let s=(0,l.useParams)(),p=(0,l.useRouter)(),{user:f,student:j,subjects:v,teachers:N}=(0,m.i)(),w=null==s?void 0:s.id,{data:_,error:k,isLoading:A}=(0,r.Ay)("/api/exam/".concat(w),h),{data:C,error:q,isLoading:M,mutate:S}=(0,r.Ay)("/api/exam-questions?exam_id=".concat(w),h),[G,P]=(0,n.useState)(null),[E,T]=(0,n.useState)([]),[H,U]=(0,n.useState)([]),[K,L]=(0,n.useState)(!1),[V,B]=(0,n.useState)(!1);(0,n.useEffect)(()=>{var e,a,s,t,n,l,r,i,o,c,d;_&&P({subject_id:null!=(t=null!=(s=_.subject_id)?s:null==(e=_.subject)?void 0:e.id)?t:0,class_id:null!=(l=null!=(n=_.class_id)?n:null==(a=_.class)?void 0:a.id)?l:0,title:null!=(r=_.title)?r:"",description:null!=(i=_.description)?i:"",date:null!=(o=_.date)?o:"",start_time:null!=(c=_.start_time)?c:"",end_time:null!=(d=_.end_time)?d:""})},[_]),(0,n.useEffect)(()=>{C&&T((Array.isArray(null==C?void 0:C.data)?C.data:Array.isArray(C)?C:[]).map(e=>({id:e.id,type:e.type,question_text:e.question_text,points:e.points,options:Array.isArray(e.options)?e.options.map(e=>({id:e.id,option_text:e.option_text,is_correct:!!e.is_correct})):y().options})))},[C]);let D=async()=>{if(G){L(!0),U([]);try{await i.A.patch("/api/exam/".concat(w),G),U(["Data ujian berhasil diperbarui."])}catch(l){var e,a,s,t;let n=null!=(t=null!=(s=null==l||null==(a=l.response)||null==(e=a.data)?void 0:e.message)?s:null==l?void 0:l.message)?t:"Gagal menyimpan data ujian.";U(["string"==typeof n?n:"Gagal menyimpan data ujian."])}finally{L(!1)}}},I=async()=>{B(!0),U([]);try{for(let e of(E.map(e=>({exam_id:Number(w),type:e.type,question_text:e.question_text,points:e.points,options:"pg"===e.type?e.options:void 0})),E))e.id?await i.A.patch("/api/exam-questions/".concat(e.id),{type:e.type,question_text:e.question_text,points:e.points,options:"pg"===e.type?e.options:void 0}):await i.A.post("/api/exam-questions",{exam_id:Number(w),type:e.type,question_text:e.question_text,points:e.points,options:"pg"===e.type?e.options:void 0});U(["Soal ujian berhasil disimpan."]),S()}catch(l){var e,a,s,t;let n=null!=(t=null!=(s=null==l||null==(a=l.response)||null==(e=a.data)?void 0:e.message)?s:null==l?void 0:l.message)?t:"Gagal menyimpan soal.";U(["string"==typeof n?n:"Gagal menyimpan soal."])}finally{B(!1)}},J=async()=>{if(confirm("Yakin ingin menghapus ujian ini?"))try{await i.A.delete("/api/exam/".concat(w)),p.push("/edu/ujian/manage")}catch(e){U(["Gagal menghapus ujian. Silakan coba lagi."])}},O=(0,n.useMemo)(()=>E.reduce((e,a)=>e+(a.points||0),0),[E]),R=(0,n.useMemo)(()=>E.some(e=>!e.question_text.trim()),[E]);return(0,t.jsx)("div",{className:"min-h-screen bg-gray-100",children:(0,t.jsxs)("main",{className:"mx-auto max-w-6xl px-4 py-6 space-y-6",children:[(0,t.jsxs)("header",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(g(),{href:"/edu/ujian/manage",className:"inline-flex items-center gap-2 text-sm text-gray-500 hover:text-gray-700",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"h-4 w-4",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})}),"Kembali ke daftar ujian"]}),(0,t.jsx)("h1",{className:"text-2xl font-semibold text-gray-900 mt-2",children:null!=(e=null==G?void 0:G.title)?e:"Kelola Ujian"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Atur informasi ujian dan kelola soal beserta kunci jawabannya."})]}),(0,t.jsxs)("button",{onClick:J,className:"inline-flex items-center gap-2 rounded-lg border border-red-200 px-4 py-2 text-sm font-medium text-red-600 hover:bg-red-50",children:[(0,t.jsx)(o.A,{className:"h-4 w-4"}),"Hapus Ujian"]})]}),H.length>0&&(0,t.jsx)("div",{className:"space-y-2",children:H.map((e,a)=>(0,t.jsxs)("div",{className:"flex items-center gap-2 rounded-xl border border-indigo-200 bg-indigo-50 p-3 text-sm text-indigo-700",children:[(0,t.jsx)(d.A,{className:"h-4 w-4"}),e]},a))}),(0,t.jsx)("section",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"rounded-2xl border border-gray-200 bg-white p-6 shadow-sm space-y-4",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Informasi Ujian"}),A&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[(0,t.jsx)(u.A,{className:"h-4 w-4 animate-spin"}),"Memuat detail ujian..."]}),k&&(0,t.jsx)("div",{className:"text-sm text-red-500",children:"Gagal memuat detail ujian. Silakan refresh halaman."}),G&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("label",{className:"space-y-1",children:[(0,t.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Judul Ujian"}),(0,t.jsx)("input",{value:G.title,onChange:e=>P({...G,title:e.target.value}),className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-orange-500 focus:outline-none focus:ring-2 focus:ring-orange-200"})]}),(0,t.jsxs)("label",{className:"space-y-1",children:[(0,t.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Deskripsi"}),(0,t.jsx)("textarea",{value:null!=(a=G.description)?a:"",onChange:e=>P({...G,description:e.target.value}),className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-orange-500 focus:outline-none focus:ring-2 focus:ring-orange-200"})]}),(0,t.jsxs)("label",{className:"space-y-1",children:[(0,t.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Tanggal Ujian"}),(0,t.jsx)("input",{type:"date",value:G.date,onChange:e=>P({...G,date:e.target.value}),className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-orange-500 focus:outline-none focus:ring-2 focus:ring-orange-200"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("label",{className:"space-y-1",children:[(0,t.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Mulai"}),(0,t.jsx)("input",{type:"time",value:G.start_time,onChange:e=>P({...G,start_time:e.target.value}),className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-orange-500 focus:outline-none focus:ring-2 focus:ring-orange-200"})]}),(0,t.jsxs)("label",{className:"space-y-1",children:[(0,t.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Selesai"}),(0,t.jsx)("input",{type:"time",value:G.end_time,onChange:e=>P({...G,end_time:e.target.value}),className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-orange-500 focus:outline-none focus:ring-2 focus:ring-orange-200"})]})]}),(0,t.jsxs)("label",{className:"space-y-1",children:[(0,t.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Mata Pelajaran"}),(0,t.jsxs)("select",{value:G.subject_id,onChange:e=>P({...G,subject_id:Number(e.target.value)}),className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-orange-500 focus:outline-none focus:ring-2 focus:ring-orange-200",children:[(0,t.jsx)("option",{value:"0",children:"Pilih Mata Pelajaran"}),null==v?void 0:v.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("label",{className:"space-y-1",children:[(0,t.jsx)("span",{className:"text-xs font-medium text-gray-500",children:"Kelas"}),(0,t.jsx)("input",{value:G.class_id,onChange:e=>P({...G,class_id:Number(e.target.value)}),className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm focus:border-orange-500 focus:outline-none focus:ring-2 focus:ring-orange-200"})]})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsxs)("button",{onClick:D,disabled:K,className:"inline-flex items-center gap-2 rounded-lg bg-orange-500 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-orange-400 disabled:cursor-not-allowed disabled:opacity-60",children:[K&&(0,t.jsx)(u.A,{className:"h-4 w-4 animate-spin"}),(0,t.jsx)(x.A,{className:"h-4 w-4"}),"Simpan Informasi Ujian"]})})]})}),(0,t.jsxs)("section",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["Daftar Soal (",E.length,")"]}),(0,t.jsxs)("button",{onClick:()=>{T(e=>[...e,y()])},className:"inline-flex items-center gap-2 rounded-lg border border-orange-200 px-4 py-2 text-sm font-medium text-orange-600 hover:bg-orange-50",children:[(0,t.jsx)(c.A,{className:"h-4 w-4"}),"Tambah Soal"]})]}),M&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[(0,t.jsx)(u.A,{className:"h-4 w-4 animate-spin"}),"Memuat soal..."]}),q&&(0,t.jsx)("div",{className:"text-sm text-red-500",children:"Gagal memuat soal. Silakan refresh halaman."}),(0,t.jsx)("div",{className:"space-y-3",children:E.map((e,a)=>{var s;return(0,t.jsx)(b,{question:e,onChange:e=>{T(s=>s.map((s,t)=>t===a?e:s))},onRemove:()=>{T(e=>e.filter((e,s)=>s!==a))},index:a},null!=(s=e.id)?s:a)})}),0===E.length&&!M&&(0,t.jsx)("div",{className:"rounded-2xl border border-dashed border-gray-300 bg-white p-6 text-center text-gray-400",children:'Belum ada soal. Klik "Tambah Soal" untuk mulai membuat soal.'}),(0,t.jsxs)("footer",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["Total skor ujian saat ini: ",(0,t.jsx)("span",{className:"font-semibold text-gray-900",children:O})," poin"]}),(0,t.jsxs)("button",{onClick:I,disabled:V||R,className:"inline-flex items-center gap-2 rounded-lg bg-emerald-500 px-4 py-2 text-sm font-semibold text-white shadow hover:bg-emerald-400 disabled:cursor-not-allowed disabled:opacity-60",children:[V&&(0,t.jsx)(u.A,{className:"h-4 w-4 animate-spin"}),"Simpan Soal & Kunci Jawaban"]})]})]})]})})}},46046:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(71847).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},54376:(e,a,s)=>{Promise.resolve().then(s.bind(s,35230))},60230:(e,a,s)=>{"use strict";s.d(a,{A:()=>r,i:()=>l});var t=s(12115);let n=(0,t.createContext)({user:null,student:null,teacher:null,students:null,teachers:null,tugas:null,subjects:null,exams:null,nilai:null,schedules:null,rooms:null,classes:null}),l=()=>(0,t.useContext)(n),r=n},71360:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(71847).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])}},e=>{e.O(0,[2619,5125,788,8441,1255,7358],()=>e(e.s=54376)),_N_E=e.O()}]);