"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1148],{12690:(t,e,i)=>{i.d(e,{AZ:()=>tD,Np:()=>eZ,S:()=>il,TL:()=>e9,Wp:()=>T,aH:()=>h,e6:()=>te,jM:()=>iz,rx:()=>tH,zY:()=>ie});var s,o=i(66504),n=i(35743),a=Object.defineProperty,r=(t,e)=>{for(var i in e)a(t,i,{get:e[i],enumerable:!0})},h={};r(h,{ACTIONS:()=>g,ANIMATION_MIN_DURATION:()=>l,CAPTURE_EVENTS_CLASS:()=>f,CTRLZOOM_TIMEOUT:()=>v,DBLCLICK_DELAY:()=>d,EASINGS:()=>_,ICONS:()=>E,IDS:()=>y,KEY_CODES:()=>b,LONGTOUCH_DELAY:()=>u,MOVE_THRESHOLD:()=>c,SPHERE_RADIUS:()=>m,TWOFINGERSOVERLAY_DELAY:()=>p,VIEWER_DATA:()=>w});var l=500,c=4,d=300,u=500,p=100,v=2e3,m=10,w="photoSphereViewer",f="psv--capture-event",g=(t=>(t.ROTATE_UP="ROTATE_UP",t.ROTATE_DOWN="ROTATE_DOWN",t.ROTATE_RIGHT="ROTATE_RIGHT",t.ROTATE_LEFT="ROTATE_LEFT",t.ZOOM_IN="ZOOM_IN",t.ZOOM_OUT="ZOOM_OUT",t))(g||{}),y={MENU:"menu",TWO_FINGERS:"twoFingers",CTRL_ZOOM:"ctrlZoom",ERROR:"error",DESCRIPTION:"description"},b={Enter:"Enter",Control:"Control",Escape:"Escape",Space:" ",PageUp:"PageUp",PageDown:"PageDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Delete:"Delete",Plus:"+",Minus:"-"},E={arrow:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="40 40 432 432"><g transform="rotate(0, 256, 256)"><path fill="currentColor" d="M425.23 210.55H227.39a5 5 0 01-3.53-8.53l56.56-56.57a45.5 45.5 0 000-64.28 45.15 45.15 0 00-32.13-13.3 45.15 45.15 0 00-32.14 13.3L41.32 256l174.83 174.83a45.15 45.15 0 0032.14 13.3 45.15 45.15 0 0032.13-13.3 45.5 45.5 0 000-64.28l-56.57-56.57a5 5 0 013.54-8.53h197.84c25.06 0 45.45-20.39 45.45-45.45s-20.4-45.45-45.45-45.45z"/></g>\x3c!-- Created by Flatart from the Noun Project --\x3e</svg>\n',close:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g fill="currentColor" transform=" translate(50, 50) rotate(45)"><rect x="-5" y="-65" width="10" height="130"/><rect x="-65" y="-5" width="130" height="10"/></g></svg>',download:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/><path fill="currentColor" d="M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/>\x3c!--Created by Michael Zenaty from the Noun Project--\x3e</svg>\n',fullscreenIn:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/>\x3c!--Created by Garrett Knoll from the Noun Project--\x3e</svg>\n',fullscreenOut:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/>\x3c!--Created by Garrett Knoll from the Noun Project--\x3e</svg>\n',info:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path fill="currentColor" d="M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/><circle fill="currentColor" cx="39.3" cy="9.2" r="8.2"/>\x3c!--Created by Arafat Uddin from the Noun Project--\x3e</svg>\n',menu:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 80 80"><g fill="currentColor"><circle r="10" cx="20" cy="20"/><circle r="10" cx="50" cy="20"/><circle r="10" cx="80" cy="20"/><circle r="10" cx="20" cy="50"/><circle r="10" cx="50" cy="50"/><circle r="10" cx="80" cy="50"/><circle r="10" cx="20" cy="80"/><circle r="10" cx="50" cy="80"/><circle r="10" cx="80" cy="80"/></g>\x3c!-- Created by Richard Kun\xe1k from the Noun Project--\x3e</svg>\n',zoomIn:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/>\x3c!--Created by Ryan Canning from the Noun Project--\x3e</svg>\n',zoomOut:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M4.006 6.746h7.459V8.73H4.006z"/>\x3c!--Created by Ryan Canning from the Noun Project--\x3e</svg>\n'},_={linear:t=>t,inQuad:t=>t*t,outQuad:t=>t*(2-t),inOutQuad:t=>t<.5?2*t*t:-1+(4-2*t)*t,inCubic:t=>t*t*t,outCubic:t=>--t*t*t+1,inOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,inQuart:t=>t*t*t*t,outQuart:t=>1- --t*t*t*t,inOutQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,inQuint:t=>t*t*t*t*t,outQuint:t=>1+--t*t*t*t*t,inOutQuint:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t,inSine:t=>1-Math.cos(Math.PI/2*t),outSine:t=>Math.sin(Math.PI/2*t),inOutSine:t=>.5-.5*Math.cos(Math.PI*t),inExpo:t=>Math.pow(2,10*(t-1)),outExpo:t=>1-Math.pow(2,-10*t),inOutExpo:t=>(t=2*t-1)<0?.5*Math.pow(2,10*t):1-.5*Math.pow(2,-10*t),inCirc:t=>1-Math.sqrt(1-t*t),outCirc:t=>Math.sqrt(1-(t-1)*(t-1)),inOutCirc:t=>(t*=2)<1?.5-.5*Math.sqrt(1-t*t):.5+.5*Math.sqrt(1-(t-=2)*t)},T={};function M(t,e){let i=t%e;return i<0&&(i+=e),i}function x(t){return t.reduce((t,e)=>t+e,0)}function L(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function C(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function P(t,e){return[0,2*Math.PI,-(2*Math.PI)].reduce((i,s)=>{let o=e-t+s;return Math.abs(o)<Math.abs(i)?o:i},1/0)}function O(t,e){return Math.acos(Math.cos(t.pitch)*Math.cos(e.pitch)*Math.cos(t.yaw-e.yaw)+Math.sin(t.pitch)*Math.sin(e.pitch))}function k([t,e],[i,s]){t-i>Math.PI?t-=2*Math.PI:t-i<-Math.PI&&(t+=2*Math.PI);let o=(i-t)*Math.cos((e+s)/2),n=s-e;return Math.sqrt(o*o+n*n)}function I(t){return"string"==typeof t?t.match(/^[a-z]/i)?document.getElementById(t):document.querySelector(t):t}function S(t,e,i){void 0===i?t.classList.toggle(e):i?t.classList.add(e):i||t.classList.remove(e)}function z(t,e){t.classList.add(...e.split(" ").filter(t=>!!t))}function D(t,e){t.classList.remove(...e.split(" ").filter(t=>!!t))}function H(t,e){let i=t;do{if(i===e)return!0;i=i.parentElement}while(i);return!1}function A(t,e){if(!t?.matches)return null;let i=t;do{if(i.matches(e))return i;i=i.parentElement}while(i);return null}function R(t){return t?.composedPath()[0]||null}function N(t,e){return t?t.composedPath().find(t=>(t instanceof HTMLElement||t instanceof SVGElement)&&t.matches(e)):null}function j(t){let e=0,i=0,s=t;for(;s;)e+=s.offsetLeft-s.scrollLeft+s.clientLeft,i+=s.offsetTop-s.scrollTop+s.clientTop,s=s.offsetParent;return{x:e-=window.scrollX,y:i-=window.scrollY}}function V(t,e){return window.getComputedStyle(t).getPropertyValue(e)}function F(t){if(t.touches.length<2)return null;let e={x:t.touches[0].clientX,y:t.touches[0].clientY},i={x:t.touches[1].clientX,y:t.touches[1].clientY};return{distance:L(e,i),angle:C(e,i),center:{x:(e.x+i.x)/2,y:(e.y+i.y)/2}}}function U(t,e=!1){return e?t===s:document.fullscreenElement===t}function W(t,e=!1){e?(s=t,t.classList.add("psv-fullscreen-emulation"),document.dispatchEvent(new Event("fullscreenchange"))):t.requestFullscreen()}function Y(t=!1){t?(s.classList.remove("psv-fullscreen-emulation"),s=null,document.dispatchEvent(new Event("fullscreenchange"))):document.exitFullscreen()}function $(t,e){let i,s=!1,o=!1,n=!1,a=!1;return"+"===e?i=e:e.split("+").forEach(t=>{switch(t){case"Shift":s=!0;break;case"Ctrl":o=!0;break;case"Alt":n=!0;break;case"Meta":a=!0;break;case"Plus":i="+";break;case"Minus":i="-";break;default:i=t}}),s===t.shiftKey&&o===t.ctrlKey&&n===t.altKey&&a===t.metaKey&&i===t.key}function X(t){return t.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,(t,e)=>(e>0?"-":"")+t.toLowerCase())}function Z(t,e){let i=!1;return function(...s){i||(i=!0,setTimeout(()=>{t.apply(this,s),i=!1},e))}}function B(t){if("object"!=typeof t||null===t||"[object Object]"!==Object.prototype.toString.call(t))return!1;if(null===Object.getPrototypeOf(t))return!0;let e=t;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function q(t,e){return function t(i,s){return Array.isArray(s)?(i&&Array.isArray(i)?i.length=0:i=[],s.forEach((e,s)=>{i[s]=t(null,e)})):"object"==typeof s?((!i||Array.isArray(i))&&(i={}),Object.keys(s).forEach(o=>{"__proto__"!==o&&("object"==typeof s[o]&&s[o]&&B(s[o])?s[o]!==e&&(i[o]?t(i[o],s[o]):i[o]=t(null,s[o])):i[o]=s[o])})):i=s,i}(t,e)}function K(t){return q(null,t)}function G(t){return!t||0===Object.keys(t).length&&t.constructor===Object}function Q(t){return null==t}function J(...t){for(let e of t)if(!Q(e))return e;return null}function tt(t){return"object"==typeof t&&null!==t}r(T,{Animation:()=>tP,Dynamic:()=>tO,MultiDynamic:()=>tk,PressHandler:()=>tI,Slider:()=>tz,SliderDirection:()=>tS,addClasses:()=>z,angle:()=>C,applyEulerInverse:()=>t_,checkClosedShadowDom:()=>tL,checkStylesheet:()=>tM,checkVersion:()=>tx,cleanCssPosition:()=>tm,clone:()=>K,createTexture:()=>tb,cssPositionIsOrdered:()=>tw,dasherize:()=>X,deepEqual:()=>function t(e,i){if(e===i)return!0;if(!(tt(e)&&tt(i))||Object.keys(e).length!==Object.keys(i).length)return!1;for(let s of Object.keys(e))if(!t(e[s],i[s]))return!1;return!0},deepmerge:()=>q,distance:()=>L,exitFullscreen:()=>Y,firstNonNull:()=>J,getAbortError:()=>to,getAngle:()=>O,getClosest:()=>A,getConfigParser:()=>tT,getElement:()=>I,getEventTarget:()=>R,getMatchingTarget:()=>N,getPosition:()=>j,getShortestArc:()=>P,getStyleProperty:()=>V,getTouchData:()=>F,getXMPValue:()=>th,greatArcDistance:()=>k,hasParent:()=>H,invertResolvableBoolean:()=>ts,isAbortError:()=>tn,isEmpty:()=>G,isExtendedPosition:()=>tr,isFullscreenEnabled:()=>U,isNil:()=>Q,isPlainObject:()=>B,keyPressMatch:()=>$,logWarn:()=>ta,mergePanoData:()=>tC,parseAngle:()=>ty,parsePoint:()=>tv,parseSpeed:()=>tf,removeClasses:()=>D,requestFullscreen:()=>W,resolveBoolean:()=>ti,speedToDuration:()=>tg,sum:()=>x,throttle:()=>Z,toggleClass:()=>S,wrap:()=>M});var te=class t extends Error{constructor(e,i){super(i&&i instanceof Error?`${e}: ${i.message}`:e),this.name="PSVError",Error.captureStackTrace?.(this,t)}};function ti(t,e){B(t)?(e(t.initial,!0),t.promise.then(t=>e(t,!1))):e(t,!0)}function ts(t){return{initial:!t.initial,promise:t.promise.then(t=>!t)}}function to(){let t=Error("Loading was aborted.");return t.name="AbortError",t}function tn(t){return t?.name==="AbortError"}function ta(t){console.warn(`PhotoSphereViewer: ${t}`)}function tr(t){return!(!t||Array.isArray(t))&&[["textureX","textureY"],["yaw","pitch"]].some(([e,i])=>void 0!==t[e]&&void 0!==t[i])}function th(t,e,i=!0){let s=t.match("<GPano:"+e+">(.*)</GPano:"+e+">");if(null!==s||null!==(s=t.match("GPano:"+e+'="(.*?)"'))){let t=i?parseInt(s[1],10):parseFloat(s[1]);return isNaN(t)?null:t}return null}var tl={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},tc=["left","center","right"],td=["top","center","bottom"],tu=[...tc,...td],tp="center";function tv(t){if(!t)return{x:.5,y:.5};if("object"==typeof t)return t;let e=t.toLocaleLowerCase().split(" ").slice(0,2);1===e.length&&(e=tl[e[0]]?[e[0],tp]:[e[0],e[0]]);let i="left"!==e[1]&&"right"!==e[1]&&"top"!==e[0]&&"bottom"!==e[0];e=e.map(t=>tl[t]||t),i||e.reverse();let s=e.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return s?{x:parseFloat(s[1])/100,y:parseFloat(s[2])/100}:{x:.5,y:.5}}function tm(t,{allowCenter:e,cssOrder:i}={allowCenter:!0,cssOrder:!0}){return t?("string"==typeof t&&(t=t.split(" ")),1===t.length&&(t[0]===tp?t=[tp,tp]:-1!==tc.indexOf(t[0])?t=[tp,t[0]]:-1!==td.indexOf(t[0])&&(t=[t[0],tp])),2!==t.length||-1===tu.indexOf(t[0])||-1===tu.indexOf(t[1]))?(ta(`Unparsable position ${t}`),null):e||t[0]!==tp||t[1]!==tp?(i&&!tw(t)&&(t=[t[1],t[0]]),t[1]===tp&&-1!==tc.indexOf(t[0])&&(t=[tp,t[0]]),t[0]===tp&&-1!==td.indexOf(t[1])&&(t=[t[1],tp]),t):(ta("Invalid position center center"),null):null}function tw(t){return -1!==td.indexOf(t[0])&&-1!==tc.indexOf(t[1])}function tf(t){let e;if("string"==typeof t){let i=t.toString().trim(),s=parseFloat(i.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),n=i.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(n.match(/(pm|per minute)$/)&&(s/=60),n){case"dpm":case"degrees per minute":case"dps":case"degrees per second":e=o.cj9.degToRad(s);break;case"rdpm":case"radians per minute":case"rdps":case"radians per second":e=s;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":e=s*Math.PI*2;break;default:throw new te(`Unknown speed unit "${n}"`)}}else e=t;return e}function tg(t,e){return"number"!=typeof t?e/Math.abs(tf(t))*1e3:Math.abs(t)}function ty(t,e=!1,i=e){let s;if("string"==typeof t){let e=t.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!e)throw new te(`Unknown angle "${t}"`);let i=parseFloat(e[1]),n=e[2];if(n)switch(n){case"deg":case"degs":s=o.cj9.degToRad(i);break;case"rad":case"rads":s=i;break;default:throw new te(`Unknown angle unit "${n}"`)}else s=i}else if("number"!=typeof t||isNaN(t))throw new te(`Unknown angle "${t}"`);else s=t;return s=M(e?s+Math.PI:s,2*Math.PI),e?o.cj9.clamp(s-Math.PI,-Math.PI/(i?2:1),Math.PI/(i?2:1)):s}function tb(t,e=!1){let i=new o.gPd(t);return i.needsUpdate=!0,i.minFilter=e?o.$_I:o.k6q,i.generateMipmaps=e,i.anisotropy=e?2:1,i}var tE=new o.PTz;function t_(t,e){tE.setFromEuler(e).invert(),t.applyQuaternion(tE)}function tT(t,e){let i=function(i){let s=K({...t,...i}),o={};for(let[i,n]of Object.entries(s)){if(e&&i in e)n=e[i](n,{rawConfig:s,defValue:t[i]});else if(!(i in t)){ta(`Unknown option ${i}`);continue}o[i]=n}return o};return i.defaults=t,i.parsers=e||{},i}function tM(t,e){"true"!==V(t,`--psv-${e}-loaded`)&&console.error(`PhotoSphereViewer: stylesheet "@photo-sphere-viewer/${e}/index.css" is not loaded`)}function tx(t,e,i){e&&e!==i&&console.error(`PhotoSphereViewer: @photo-sphere-viewer/${t} is in version ${e} but @photo-sphere-viewer/core is in version ${i}`)}function tL(t){do{if(t instanceof ShadowRoot&&"closed"===t.mode)return void console.error("PhotoSphereViewer: closed shadow DOM detected, the viewer might not work as expected");t=t.parentNode}while(t)}function tC(t,e,i,s){let o={isEquirectangular:!0,fullWidth:J(i?.fullWidth,s?.fullWidth),fullHeight:J(i?.fullHeight,s?.fullHeight),croppedWidth:t,croppedHeight:e,croppedX:J(i?.croppedX,s?.croppedX),croppedY:J(i?.croppedY,s?.croppedY),poseHeading:J(i?.poseHeading,s?.poseHeading,0),posePitch:J(i?.posePitch,s?.posePitch,0),poseRoll:J(i?.poseRoll,s?.poseRoll,0),initialHeading:s?.initialHeading,initialPitch:s?.initialPitch,initialFov:s?.initialFov};return o.fullWidth||o.fullHeight||(o.fullWidth=Math.max(t,2*e),o.fullHeight=Math.round(o.fullWidth/2)),o.fullWidth||(o.fullWidth=2*o.fullHeight),o.fullHeight||(o.fullHeight=Math.round(o.fullWidth/2)),null===o.croppedX&&(o.croppedX=Math.round((o.fullWidth-t)/2)),null===o.croppedY&&(o.croppedY=Math.round((o.fullHeight-e)/2)),Math.abs(o.fullWidth-2*o.fullHeight)>1&&(ta("Invalid panoData, fullWidth should be twice fullHeight"),o.fullHeight=Math.round(o.fullWidth/2)),o.croppedX+o.croppedWidth>o.fullWidth&&(ta("Invalid panoData, croppedX + croppedWidth > fullWidth"),o.croppedX=o.fullWidth-o.croppedWidth),o.croppedY+o.croppedHeight>o.fullHeight&&(ta("Invalid panoData, croppedY + croppedHeight > fullHeight"),o.croppedY=o.fullHeight-o.croppedHeight),o.croppedX<0&&(ta("Invalid panoData, croppedX < 0"),o.croppedX=0),o.croppedY<0&&(ta("Invalid panoData, croppedY < 0"),o.croppedY=0),o}var tP=class{constructor(t){this.easing=_.linear,this.callbacks=[],this.resolved=!1,this.cancelled=!1,this.options=t,t?(t.easing&&(this.easing="function"==typeof t.easing?t.easing:_[t.easing]||_.linear),this.delayTimeout=setTimeout(()=>{this.delayTimeout=void 0,this.animationFrame=window.requestAnimationFrame(t=>this.__run(t))},t.delay||0)):this.resolved=!0}__run(t){if(this.cancelled)return;this.start||(this.start=t);let e=(t-this.start)/this.options.duration,i={};if(e<1){for(let[t,s]of Object.entries(this.options.properties))if(s){let o=s.start+(s.end-s.start)*this.easing(e);i[t]=o}this.options.onTick(i,e),this.animationFrame=window.requestAnimationFrame(t=>this.__run(t))}else{for(let[t,e]of Object.entries(this.options.properties))e&&(i[t]=e.end);this.options.onTick(i,1),this.__resolve(!0),this.animationFrame=void 0}}__resolve(t){t?this.resolved=!0:this.cancelled=!0,this.callbacks.forEach(e=>e(t)),this.callbacks.length=0}then(t){return this.resolved||this.cancelled?Promise.resolve(this.resolved).then(t):new Promise(t=>{this.callbacks.push(t)}).then(t)}cancel(){this.cancelled||this.resolved||(this.__resolve(!1),this.delayTimeout&&(window.clearTimeout(this.delayTimeout),this.delayTimeout=void 0),this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0))}},tO=class{constructor(t,e){if(this.fn=t,this.mode=0,this.speed=0,this.speedMult=0,this.currentSpeed=0,this.target=0,this.__current=0,this.min=e.min,this.max=e.max,this.wrap=e.wrap,this.current=e.defaultValue,this.wrap&&0!==this.min)throw new te("invalid config");this.fn&&this.fn(this.current)}get current(){return this.__current}set current(t){this.__current=t}setSpeed(t){this.speed=t}goto(t,e=1){this.mode=2,this.target=this.wrap?M(t,this.max):o.cj9.clamp(t,this.min,this.max),this.speedMult=e}step(t,e=1){0===e?this.setValue(this.current+t):(2!==this.mode&&(this.target=this.current),this.goto(this.target+t,e))}roll(t=!1,e=1){this.mode=1,this.target=t?-1/0:1/0,this.speedMult=e}stop(){this.mode=0}setValue(t){return this.target=this.wrap?M(t,this.max):o.cj9.clamp(t,this.min,this.max),this.mode=0,this.currentSpeed=0,this.target!==this.current&&(this.current=this.target,this.fn&&this.fn(this.current),!0)}update(t){if(2===this.mode){this.wrap&&Math.abs(this.target-this.current)>this.max/2&&(this.current=this.current<this.target?this.current+this.max:this.current-this.max);let t=this.currentSpeed*this.currentSpeed/(this.speed*this.speedMult*4);Math.abs(this.target-this.current)<=t&&(this.mode=0)}let e=0===this.mode?0:this.speed*this.speedMult;this.target<this.current&&(e=-e),this.currentSpeed<e?this.currentSpeed=Math.min(e,this.currentSpeed+t/1e3*this.speed*this.speedMult*2):this.currentSpeed>e&&(this.currentSpeed=Math.max(e,this.currentSpeed-t/1e3*this.speed*this.speedMult*2));let i=null;return this.current>this.target&&this.currentSpeed?i=Math.max(this.target,this.current+this.currentSpeed*t/1e3):this.current<this.target&&this.currentSpeed&&(i=Math.min(this.target,this.current+this.currentSpeed*t/1e3)),null!==i&&(i=this.wrap?M(i,this.max):o.cj9.clamp(i,this.min,this.max))!==this.current&&(this.current=i,this.fn&&this.fn(this.current),!0)}},tk=class{constructor(t,e){this.fn=t,this.dynamics=e,this.fn&&this.fn(this.current)}get current(){return Object.entries(this.dynamics).reduce((t,[e,i])=>(t[e]=i.current,t),{})}setSpeed(t){for(let e of Object.values(this.dynamics))e.setSpeed(t)}goto(t,e=1){for(let[i,s]of Object.entries(t))this.dynamics[i].goto(s,e)}step(t,e=1){if(0===e)this.setValue(Object.keys(t).reduce((e,i)=>(e[i]=t[i]+this.dynamics[i].current,e),{}));else for(let[i,s]of Object.entries(t))this.dynamics[i].step(s,e)}roll(t,e=1){for(let[i,s]of Object.entries(t))this.dynamics[i].roll(s,e)}stop(){for(let t of Object.values(this.dynamics))t.stop()}setValue(t){let e=!1;for(let[i,s]of Object.entries(t))e=this.dynamics[i].setValue(s)||e;return e&&this.fn&&this.fn(this.current),e}update(t){let e=!1;for(let i of Object.values(this.dynamics))e=i.update(t)||e;return e&&this.fn&&this.fn(this.current),e}},tI=class{constructor(t=200){this.delay=t,this.time=0,this.delay=t}get pending(){return 0!==this.time}down(t){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.time=new Date().getTime(),this.data=t}up(t){this.time&&(Date.now()-this.time<this.delay?this.timeout=setTimeout(()=>{t(this.data),this.timeout=void 0,this.time=0,this.data=void 0},this.delay):(t(this.data),this.time=0,this.data=void 0))}},tS=(t=>(t.VERTICAL="VERTICAL",t.HORIZONTAL="HORIZONTAL",t))(tS||{}),tz=class{constructor(t,e,i){this.container=t,this.direction=e,this.listener=i,this.mousedown=!1,this.mouseover=!1,this.container.addEventListener("click",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("touchmove",this,!0),window.addEventListener("mouseup",this),window.addEventListener("touchend",this)}get isVertical(){return"VERTICAL"===this.direction}get isHorizontal(){return"HORIZONTAL"===this.direction}destroy(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this)}handleEvent(t){switch(t.type){case"click":t.stopPropagation();break;case"mousedown":this.__onMouseDown(t);break;case"mouseenter":this.__onMouseEnter(t);break;case"mouseleave":this.__onMouseLeave(t);break;case"touchstart":this.__onTouchStart(t);break;case"mousemove":this.__onMouseMove(t);break;case"touchmove":this.__onTouchMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchend":this.__onTouchEnd(t)}}__onMouseDown(t){this.mousedown=!0,this.__update(t.clientX,t.clientY,!0)}__onMouseEnter(t){this.mouseover=!0,this.__update(t.clientX,t.clientY,!0)}__onTouchStart(t){this.mouseover=!0,this.mousedown=!0;let e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!0)}__onMouseMove(t){(this.mousedown||this.mouseover)&&(t.stopPropagation(),this.__update(t.clientX,t.clientY,!0))}__onTouchMove(t){if(this.mousedown||this.mouseover){t.stopPropagation();let e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!0)}}__onMouseUp(t){this.mousedown&&(this.mousedown=!1,this.__update(t.clientX,t.clientY,!1))}__onMouseLeave(t){this.mouseover&&(this.mouseover=!1,this.__update(t.clientX,t.clientY,!0))}__onTouchEnd(t){if(this.mousedown){this.mouseover=!1,this.mousedown=!1;let e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!1)}}__update(t,e,i){let s,n=this.container.getBoundingClientRect();s=this.isVertical?o.cj9.clamp((n.bottom-e)/n.height,0,1):o.cj9.clamp((t-n.left)/n.width,0,1),this.listener({value:s,click:!i,mousedown:this.mousedown,mouseover:this.mouseover,cursor:{clientX:t,clientY:e}})}},tD={};r(tD,{BeforeAnimateEvent:()=>tj,BeforeRenderEvent:()=>tF,BeforeRotateEvent:()=>tW,ClickEvent:()=>t$,ConfigChangedEvent:()=>tZ,DoubleClickEvent:()=>tq,FullscreenEvent:()=>tG,HideNotificationEvent:()=>tJ,HideOverlayEvent:()=>t1,HidePanelEvent:()=>t3,HideTooltipEvent:()=>t4,KeypressEvent:()=>t7,LoadProgressEvent:()=>t9,ObjectEnterEvent:()=>eS,ObjectEvent:()=>ek,ObjectHoverEvent:()=>eA,ObjectLeaveEvent:()=>eD,PanoramaErrorEvent:()=>en,PanoramaLoadEvent:()=>ee,PanoramaLoadedEvent:()=>es,PositionUpdatedEvent:()=>el,ReadyEvent:()=>ep,RenderEvent:()=>em,RollUpdatedEvent:()=>ed,ShowNotificationEvent:()=>ef,ShowOverlayEvent:()=>ey,ShowPanelEvent:()=>eE,ShowTooltipEvent:()=>eT,SizeUpdatedEvent:()=>ex,StopAllEvent:()=>eC,TransitionDoneEvent:()=>er,ViewerEvent:()=>tR,ZoomUpdatedEvent:()=>eO});var tH=class extends Event{constructor(t,e=!1){super(t,{cancelable:e})}},tA=class extends EventTarget{dispatchEvent(t){return super.dispatchEvent(t)}addEventListener(t,e,i){super.addEventListener(t,e,i)}removeEventListener(t,e,i){super.removeEventListener(t,e,i)}},tR=class extends tH{},tN=class t extends tR{constructor(e,i){super(t.type,!0),this.position=e,this.zoomLevel=i}};tN.type="before-animate";var tj=tN,tV=class t extends tR{constructor(e,i){super(t.type),this.timestamp=e,this.elapsed=i}};tV.type="before-render";var tF=tV,tU=class t extends tR{constructor(e){super(t.type,!0),this.position=e}};tU.type="before-rotate";var tW=tU,tY=class t extends tR{constructor(e){super(t.type),this.data=e}};tY.type="click";var t$=tY,tX=class t extends tR{constructor(e){super(t.type),this.options=e}containsOptions(...t){return t.some(t=>this.options.includes(t))}};tX.type="config-changed";var tZ=tX,tB=class t extends tR{constructor(e){super(t.type),this.data=e}};tB.type="dblclick";var tq=tB,tK=class t extends tR{constructor(e){super(t.type),this.fullscreenEnabled=e}};tK.type="fullscreen";var tG=tK,tQ=class t extends tR{constructor(e){super(t.type),this.notificationId=e}};tQ.type="hide-notification";var tJ=tQ,t0=class t extends tR{constructor(e){super(t.type),this.overlayId=e}};t0.type="hide-overlay";var t1=t0,t2=class t extends tR{constructor(e){super(t.type),this.panelId=e}};t2.type="hide-panel";var t3=t2,t5=class t extends tR{constructor(e){super(t.type),this.tooltipData=e}};t5.type="hide-tooltip";var t4=t5,t8=class t extends tR{constructor(e,i){super(t.type,!0),this.key=e,this.originalEvent=i}matches(t){return $(this.originalEvent,t)}};t8.type="key-press";var t7=t8,t6=class t extends tR{constructor(e){super(t.type),this.progress=e}};t6.type="load-progress";var t9=t6,et=class t extends tR{constructor(e){super(t.type),this.panorama=e}};et.type="panorama-load";var ee=et,ei=class t extends tR{constructor(e){super(t.type),this.data=e}};ei.type="panorama-loaded";var es=ei,eo=class t extends tR{constructor(e,i){super(t.type),this.panorama=e,this.error=i}};eo.type="panorama-error";var en=eo,ea=class t extends tR{constructor(e){super(t.type),this.completed=e}};ea.type="transition-done";var er=ea,eh=class t extends tR{constructor(e){super(t.type),this.position=e}};eh.type="position-updated";var el=eh,ec=class t extends tR{constructor(e){super(t.type),this.roll=e}};ec.type="roll-updated";var ed=ec,eu=class t extends tR{constructor(){super(t.type)}};eu.type="ready";var ep=eu,ev=class t extends tR{constructor(){super(t.type)}};ev.type="render";var em=ev,ew=class t extends tR{constructor(e){super(t.type),this.notificationId=e}};ew.type="show-notification";var ef=ew,eg=class t extends tR{constructor(e){super(t.type),this.overlayId=e}};eg.type="show-overlay";var ey=eg,eb=class t extends tR{constructor(e){super(t.type),this.panelId=e}};eb.type="show-panel";var eE=eb,e_=class t extends tR{constructor(e,i){super(t.type),this.tooltip=e,this.tooltipData=i}};e_.type="show-tooltip";var eT=e_,eM=class t extends tR{constructor(e){super(t.type),this.size=e}};eM.type="size-updated";var ex=eM,eL=class t extends tR{constructor(){super(t.type)}};eL.type="stop-all";var eC=eL,eP=class t extends tR{constructor(e){super(t.type),this.zoomLevel=e}};eP.type="zoom-updated";var eO=eP,ek=class extends tR{constructor(t,e,i,s,o){super(t),this.originalEvent=e,this.object=i,this.viewerPoint=s,this.userDataKey=o}},eI=class t extends ek{constructor(e,i,s,o){super(t.type,e,i,s,o)}};eI.type="enter-object";var eS=eI,ez=class t extends ek{constructor(e,i,s,o){super(t.type,e,i,s,o)}};ez.type="leave-object";var eD=ez,eH=class t extends ek{constructor(e,i,s,o){super(t.type,e,i,s,o)}};eH.type="hover-object";var eA=eH,eR=class{constructor(t){this.viewer=t}init(){}destroy(){}supportsTransition(t){return!1}supportsPreload(t){return!1}textureCoordsToSphericalCoords(t,e){throw new te("Current adapter does not support texture coordinates.")}sphericalCoordsToTextureCoords(t,e){throw new te("Current adapter does not support texture coordinates.")}};function eN(t){if(t){for(let[,e]of[["_",t],...Object.entries(t)])if(e.prototype instanceof eR)return tx(e.id,e.VERSION,"5.14.0"),e}return null}eR.supportsDownload=!1;var ej=`${w}_touchSupport`,eV={loaded:!1,pixelRatio:1,isWebGLSupported:!1,maxTextureWidth:0,isTouchEnabled:null,__maxCanvasWidth:null,isIphone:!1,get maxCanvasWidth(){return null===this.__maxCanvasWidth&&(this.__maxCanvasWidth=function(t){let e=t,i=!1,s=document.createElement("canvas"),o=s.getContext("2d");for(s.width=1,s.height=1;e>1024&&!i;){let t=document.createElement("canvas"),s=t.getContext("2d");t.width=e,t.height=e/2;try{s.fillStyle="white",s.fillRect(e-1,e/2-1,1,1),o.drawImage(t,e-1,e/2-1,1,1,0,0,1,1),o.getImageData(0,0,1,1).data[0]>0&&(i=!0)}catch{}t.width=0,t.height=0,i||(e/=2)}if(i)return e;throw new te("Unable to detect system capabilities")}(this.maxTextureWidth)),this.__maxCanvasWidth},load(){if(!this.loaded){let t=function(){try{return document.createElement("canvas").getContext("webgl2")}catch{return null}}();this.pixelRatio=window.devicePixelRatio||1,this.isWebGLSupported=!!t,this.maxTextureWidth=t?t.getParameter(t.MAX_TEXTURE_SIZE):0,this.isTouchEnabled=function(){let t="ontouchstart"in window||navigator.maxTouchPoints>0;ej in localStorage&&(t="true"===localStorage[ej]);let e=new Promise(e=>{let i=()=>{window.removeEventListener("mousedown",s),window.removeEventListener("touchstart",o),clearTimeout(n)},s=()=>{i(),localStorage[ej]=!1,e(!1)},o=()=>{i(),localStorage[ej]=!0,e(!0)};window.addEventListener("mousedown",s,!1),window.addEventListener("touchstart",o,!1);let n=setTimeout(()=>{i(),localStorage[ej]=t,e(t)},1e4)});return{initial:t,promise:e}}(),this.isIphone=/iPhone/i.test(navigator.userAgent),this.loaded=!0}if(!eV.isWebGLSupported)throw new te("WebGL 2 is not supported.");if(0===eV.maxTextureWidth)throw new te("Unable to detect system capabilities")}},eF=tT({resolution:64,useXmpData:!0,blur:!1},{resolution:t=>{if(!t||!o.cj9.isPowerOfTwo(t))throw new te("EquirectangularAdapter resolution must be power of two.");return t}}),eU=class t extends eR{static withConfig(e){return[t,e]}constructor(t,e){super(t),this.config=eF(e),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2}supportsTransition(){return!0}supportsPreload(){return!0}textureCoordsToSphericalCoords(t,e){if(Q(t.textureX)||Q(t.textureY))throw new te("Texture position is missing 'textureX' or 'textureY'");let i=(t.textureX+e.croppedX)/e.fullWidth*Math.PI*2;return{yaw:i>=Math.PI?i-Math.PI:i+Math.PI,pitch:Math.PI/2-(t.textureY+e.croppedY)/e.fullHeight*Math.PI}}sphericalCoordsToTextureCoords(t,e){let i=t.yaw/Math.PI/2*e.fullWidth,s=t.pitch/Math.PI*e.fullHeight,o=Math.round(t.yaw<Math.PI?i+e.fullWidth/2:i-e.fullWidth/2)-e.croppedX,n=Math.round(e.fullHeight/2-s)-e.croppedY;return(o<0||o>e.croppedWidth||n<0||n>e.croppedHeight)&&(o=n=void 0),{textureX:o,textureY:n}}async loadTexture(t,e=!0,i,s=this.config.useXmpData){let o;if("string"!=typeof t&&("object"!=typeof t||!t.path))return Promise.reject(new te("Invalid panorama url, are you using the right adapter?"));o="string"==typeof t?{path:t,data:i}:{data:i,...t};let n=await this.viewer.textureLoader.loadFile(o.path,e?t=>this.viewer.textureLoader.dispatchProgress(t):null,o.path),a=s?await this.loadXMP(n):null,r=await this.viewer.textureLoader.blobToImage(n);"function"==typeof o.data&&(o.data=o.data(r,a));let h=tC(r.width,r.height,o.data,a);return{panorama:t,texture:this.createEquirectangularTexture(r),panoData:h,cacheKey:o.path}}async loadXMP(t){let e=await this.loadBlobAsString(t),i=e.indexOf("<x:xmpmeta");if(-1===i)return null;let s=e.indexOf("</x:xmpmeta>",i);if(-1===s)return null;let o=e.substring(i,s);return o.includes("GPano:")?{fullWidth:th(o,"FullPanoWidthPixels"),fullHeight:th(o,"FullPanoHeightPixels"),croppedWidth:th(o,"CroppedAreaImageWidthPixels"),croppedHeight:th(o,"CroppedAreaImageHeightPixels"),croppedX:th(o,"CroppedAreaLeftPixels"),croppedY:th(o,"CroppedAreaTopPixels"),poseHeading:th(o,"PoseHeadingDegrees",!1),posePitch:th(o,"PosePitchDegrees",!1),poseRoll:th(o,"PoseRollDegrees",!1),initialHeading:th(o,"InitialViewHeadingDegrees",!1),initialPitch:th(o,"InitialViewPitchDegrees",!1),initialFov:th(o,"InitialHorizontalFOVDegrees",!1)}:null}loadBlobAsString(t){return new Promise((e,i)=>{let s=new FileReader;s.onload=()=>e(s.result),s.onerror=i,s.readAsText(t)})}createEquirectangularTexture(t){if(this.config.blur||t.width>eV.maxTextureWidth){let e=Math.min(1,eV.maxCanvasWidth/t.width),i=new OffscreenCanvas(Math.floor(t.width*e),Math.floor(t.height*e)),s=i.getContext("2d");return this.config.blur&&(s.filter=`blur(${i.width/2048}px)`),s.drawImage(t,0,0,i.width,i.height),tb(i)}return tb(t)}createMesh(t){let e=t.croppedX/t.fullWidth*2*Math.PI,i=t.croppedWidth/t.fullWidth*2*Math.PI,s=t.croppedY/t.fullHeight*Math.PI,n=t.croppedHeight/t.fullHeight*Math.PI,a=new o.Gu$(m,Math.round(this.SPHERE_SEGMENTS/(2*Math.PI)*i),Math.round(this.SPHERE_HORIZONTAL_SEGMENTS/Math.PI*n),-Math.PI/2+e,i,s,n).scale(-1,1,1),r=new o.V9B({depthTest:!1,depthWrite:!1});return new o.eaF(a,r)}setTexture(t,e){t.material.map=e.texture}setTextureOpacity(t,e){t.material.opacity=e,t.material.transparent=e<1}disposeTexture({texture:t}){t.dispose()}disposeMesh(t){t.geometry.dispose(),t.material.dispose()}};eU.id="equirectangular",eU.VERSION="5.14.0",eU.supportsDownload=!0;var eW=eU,eY=class t extends eW{static withConfig(e){return[t,e]}constructor(t,e){super(t,{resolution:e?.resolution??64,useXmpData:!1})}async loadTexture(t,e){let i=await super.loadTexture(t,e,null,!1);return i.panoData=null,i}createMesh(){let t=new o.Gu$(m,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS).scale(-1,1,1).toNonIndexed(),e=t.getAttribute("uv"),i=t.getAttribute("normal");for(let t=0;t<e.count;t++)for(let s=0;s<3;s++){let o=3*t+s,n=i.getX(o),a=i.getY(o),r=i.getZ(o);if(t<e.count/6){let t=0===n&&0===r?1:Math.acos(a)/Math.sqrt(n*n+r*r)*(2/Math.PI);e.setXY(o,.23675*n*t+1/4,.4735*r*t+.5)}else{let t=0===n&&0===r?1:Math.acos(-a)/Math.sqrt(n*n+r*r)*(2/Math.PI);e.setXY(o,-(.23675*n)*t+3/4,.4735*r*t+.5)}}t.rotateX(-Math.PI/2),t.rotateY(Math.PI);let s=new o.V9B({depthTest:!1,depthWrite:!1});return new o.eaF(t,s)}};eY.id="dual-fisheye",eY.VERSION="5.14.0";var e$=class t{constructor(e,i){this.parent=e,this.children=[],this.state={visible:!0},this.viewer=e instanceof t?e.viewer:e,this.container=document.createElement(i.tagName??"div"),this.container.className=i.className||"",this.parent.children.push(this),this.parent.container.appendChild(this.container)}destroy(){this.parent.container.removeChild(this.container);let t=this.parent.children.indexOf(this);-1!==t&&this.parent.children.splice(t,1),this.children.slice().forEach(t=>t.destroy()),this.children.length=0}toggle(t=!this.isVisible()){t?this.show():this.hide()}hide(t){this.container.style.display="none",this.state.visible=!1}show(t){this.container.style.display="",this.state.visible=!0}isVisible(){return this.state.visible}},eX=tT({id:null,tagName:null,className:null,title:null,hoverScale:!1,collapsable:!1,tabbable:!0,icon:null,iconActive:null}),eZ=class extends e${constructor(t,e){super(t,{tagName:e.tagName,className:`psv-button ${e.hoverScale?"psv-button--hover-scale":""} ${e.className||""}`}),this.state={visible:!0,enabled:!0,supported:!0,collapsed:!1,active:!1,width:0},this.config=eX(e),e.id||(this.config.id=this.constructor.id),e.icon&&this.__setIcon(e.icon),this.state.width=this.container.offsetWidth,this.config.title?this.container.title=this.viewer.config.lang[this.config.title]??this.config.title:this.id&&this.id in this.viewer.config.lang&&(this.container.title=this.viewer.config.lang[this.id]),e.tabbable&&(this.container.tabIndex=0),this.container.addEventListener("click",t=>{this.state.enabled&&this.onClick(),t.stopPropagation()}),this.container.addEventListener("keydown",t=>{t.key===b.Enter&&this.state.enabled&&(this.onClick(),t.stopPropagation())})}get id(){return this.config.id}get title(){return this.container.title}get content(){return this.container.innerHTML}get width(){return this.state.width}get collapsable(){return this.config.collapsable}show(t=!0){!this.isVisible()&&(this.state.visible=!0,this.state.collapsed||(this.container.style.display=""),t&&this.viewer.navbar.autoSize())}hide(t=!0){this.isVisible()&&(this.state.visible=!1,this.container.style.display="none",t&&this.viewer.navbar.autoSize())}checkSupported(){ti(this.isSupported(),(t,e)=>{this.state&&(this.state.supported=t,e?t||this.hide():this.toggle(t))})}autoSize(){}isSupported(){return!0}toggleActive(t=!this.state.active){t!==this.state.active&&(this.state.active=t,S(this.container,"psv-button--active",this.state.active),this.config.iconActive&&this.__setIcon(this.state.active?this.config.iconActive:this.config.icon))}disable(){this.container.classList.add("psv-button--disabled"),this.state.enabled=!1}enable(){this.container.classList.remove("psv-button--disabled"),this.state.enabled=!0}collapse(){this.state.collapsed=!0,this.container.style.display="none"}uncollapse(){this.state.collapsed=!1,this.state.visible&&(this.container.style.display="")}__setIcon(t){this.container.innerHTML=t,z(this.container.querySelector("svg"),"psv-button-svg")}},eB=class extends eZ{constructor(t,e){super(t,{id:e.id??`psvButton-${Math.random().toString(36).substring(2)}`,className:`psv-custom-button ${e.className||""}`,hoverScale:!1,collapsable:!1!==e.collapsable,tabbable:!1!==e.tabbable,title:e.title}),this.customOnClick=e.onClick,e.content&&("string"==typeof e.content?this.container.innerHTML=e.content:(this.container.classList.add("psv-custom-button--no-padding"),e.content.style.height="100%",e.content.attachViewer?.(this.viewer),this.container.appendChild(e.content))),this.state.width=this.container.offsetWidth,e.disabled&&this.disable(),!1===e.visible&&this.hide()}onClick(){this.customOnClick?.(this.viewer)}},eq=class extends eZ{constructor(t){super(t,{className:"psv-description-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:E.info}),this.mode=0,this.viewer.addEventListener(tJ.type,this),this.viewer.addEventListener(ef.type,this),this.viewer.addEventListener(t3.type,this),this.viewer.addEventListener(eE.type,this),this.viewer.addEventListener(tZ.type,this)}destroy(){this.viewer.removeEventListener(tJ.type,this),this.viewer.removeEventListener(ef.type,this),this.viewer.removeEventListener(t3.type,this),this.viewer.removeEventListener(eE.type,this),this.viewer.removeEventListener(tZ.type,this),super.destroy()}handleEvent(t){if(t instanceof tZ){t.containsOptions("description")&&this.autoSize(!0);return}if(!this.mode)return;let e=!1;t instanceof tJ?e=1===this.mode:t instanceof ef?e=1===this.mode&&t.notificationId!==y.DESCRIPTION:t instanceof t3?e=2===this.mode:t instanceof eE&&(e=2===this.mode&&t.panelId!==y.DESCRIPTION),e&&(this.toggleActive(!1),this.mode=0)}onClick(){this.mode?this.__close():this.__open()}hide(t){super.hide(t),this.mode&&this.__close()}autoSize(t=!1){if(t){let t=this.viewer.navbar.getButton("caption",!1),e=t&&!t.isVisible(),i=!!this.viewer.config.description;e||i?this.show(!1):this.hide(!1)}}__close(){switch(this.mode){case 1:this.viewer.notification.hide(y.DESCRIPTION);break;case 2:this.viewer.panel.hide(y.DESCRIPTION)}}__open(){this.toggleActive(!0),this.viewer.config.description?(this.mode=2,this.viewer.panel.show({id:y.DESCRIPTION,content:`${this.viewer.config.caption?`<p>${this.viewer.config.caption}</p>`:""}${this.viewer.config.description}`})):(this.mode=1,this.viewer.notification.show({id:y.DESCRIPTION,content:this.viewer.config.caption}))}};eq.id="description";var eK=class extends eZ{constructor(t){super(t,{tagName:"a",className:"psv-download-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:E.download}),this.viewer.addEventListener(tZ.type,this),this.viewer.addEventListener(es.type,this)}destroy(){this.viewer.removeEventListener(tZ.type,this),this.viewer.removeEventListener(es.type,this),super.destroy()}handleEvent(t){t instanceof tZ?(t.containsOptions("downloadUrl")&&this.checkSupported(),t.containsOptions("downloadUrl","downloadName")&&this.__update()):t instanceof es&&this.__update()}onClick(){}checkSupported(){this.viewer.adapter.constructor.supportsDownload||this.viewer.config.downloadUrl?this.show():this.hide()}__update(){let t=this.container;t.href=this.viewer.config.downloadUrl||this.viewer.config.panorama,t.target="_blank",t.href.startsWith("data:")&&!this.viewer.config.downloadName?t.download="panorama."+t.href.substring(0,t.href.indexOf(";")).split("/").pop():t.download=this.viewer.config.downloadName||t.href.split("/").pop()}};eK.id="download";var eG=class extends eZ{constructor(t){super(t,{className:"psv-fullscreen-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:E.fullscreenIn,iconActive:E.fullscreenOut}),this.viewer.addEventListener(tG.type,this)}destroy(){this.viewer.removeEventListener(tG.type,this),super.destroy()}handleEvent(t){t instanceof tG&&this.toggleActive(t.fullscreenEnabled)}onClick(){this.viewer.toggleFullscreen()}};eG.id="fullscreen";var eQ=class extends eZ{constructor(t){super(t,{className:"psv-menu-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:E.menu}),this.viewer.addEventListener(eE.type,this),this.viewer.addEventListener(t3.type,this),super.hide()}destroy(){this.viewer.removeEventListener(eE.type,this),this.viewer.removeEventListener(t3.type,this),super.destroy()}handleEvent(t){t instanceof eE?this.toggleActive(t.panelId===y.MENU):t instanceof t3&&this.toggleActive(!1)}onClick(){this.state.active?this.__hideMenu():this.__showMenu()}hide(t){super.hide(t),this.__hideMenu()}show(t){super.show(t),this.state.active&&this.__showMenu()}__showMenu(){let t,e;this.viewer.panel.show({id:y.MENU,content:(t=this.viewer.navbar.collapsed,e=this.viewer.config.lang.menu,`
<div class="psv-panel-menu psv-panel-menu--stripped">
  <h1 class="psv-panel-menu-title">${E.menu} ${e}</h1>
  <ul class="psv-panel-menu-list">
    ${t.map(t=>`
    <li data-psv-button="${t.id}" class="psv-panel-menu-item" tabindex="0">
      <span class="psv-panel-menu-item-icon">${t.content}</span>
      <span class="psv-panel-menu-item-label">${t.title}</span>
    </li>
    `).join("")}
  </ul>
</div>
`),noMargin:!0,clickHandler:t=>{let e=t?A(t,".psv-panel-menu-item"):void 0,i=e?e.dataset.psvButton:void 0;i&&(this.viewer.navbar.getButton(i).onClick(),this.__hideMenu())}})}__hideMenu(){this.viewer.panel.hide(y.MENU)}};eQ.id="menu";var eJ=class extends eZ{constructor(t,e){super(t,{className:"psv-move-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:function(t){let e=0;switch(t){case 0:e=90;break;case 1:e=-90;break;case 3:e=180;break;default:e=0}return E.arrow.replace("rotate(0",`rotate(${e}`)}(e)}),this.direction=e,this.handler=new tI,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown();break;case"mouseup":case"touchend":this.__onMouseUp();break;case"keydown":t.key===b.Enter&&this.__onMouseDown();break;case"keyup":t.key===b.Enter&&this.__onMouseUp()}}onClick(){}isSupported(){return ts(eV.isTouchEnabled)}__onMouseDown(){if(!this.state.enabled)return;let t={};switch(this.direction){case 0:t.pitch=!1;break;case 1:t.pitch=!0;break;case 3:t.yaw=!1;break;default:t.yaw=!0}this.viewer.stopAll(),this.viewer.dynamics.position.roll(t),this.handler.down()}__onMouseUp(){this.state.enabled&&this.handler.up(()=>{this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer()})}};eJ.groupId="move";var e0=class extends eJ{constructor(t){super(t,1)}};e0.id="moveDown";var e1=class extends eJ{constructor(t){super(t,2)}};e1.id="moveLeft";var e2=class extends eJ{constructor(t){super(t,3)}};e2.id="moveRight";var e3=class extends eJ{constructor(t){super(t,0)}};e3.id="moveUp";var e5=class extends eZ{constructor(t,e,i){super(t,{className:"psv-zoom-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:e}),this.direction=i,this.handler=new tI,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown();break;case"mouseup":case"touchend":this.__onMouseUp();break;case"keydown":t.key===b.Enter&&this.__onMouseDown();break;case"keyup":t.key===b.Enter&&this.__onMouseUp()}}onClick(){}isSupported(){return ts(eV.isTouchEnabled)}__onMouseDown(){this.state.enabled&&(this.viewer.dynamics.zoom.roll(1===this.direction),this.handler.down())}__onMouseUp(){this.state.enabled&&this.handler.up(()=>this.viewer.dynamics.zoom.stop())}};e5.groupId="zoom";var e4=class extends e5{constructor(t){super(t,E.zoomIn,0)}};e4.id="zoomIn";var e8=class extends e5{constructor(t){super(t,E.zoomOut,1)}};e8.id="zoomOut";var e7=class extends eZ{constructor(t){super(t,{className:"psv-zoom-range",hoverScale:!1,collapsable:!1,tabbable:!1}),this.zoomRange=document.createElement("div"),this.zoomRange.className="psv-zoom-range-line",this.container.appendChild(this.zoomRange),this.zoomValue=document.createElement("div"),this.zoomValue.className="psv-zoom-range-handle",this.zoomRange.appendChild(this.zoomValue),this.slider=new tz(this.container,"HORIZONTAL",t=>this.__onSliderUpdate(t)),this.mediaMinWidth=parseInt(V(this.container,"max-width"),10),this.viewer.addEventListener(eO.type,this),this.viewer.state.ready?this.__moveZoomValue(this.viewer.getZoomLevel()):this.viewer.addEventListener(ep.type,this)}destroy(){this.slider.destroy(),this.viewer.removeEventListener(eO.type,this),this.viewer.removeEventListener(ep.type,this),super.destroy()}handleEvent(t){t instanceof eO?this.__moveZoomValue(t.zoomLevel):t instanceof ep&&this.__moveZoomValue(this.viewer.getZoomLevel())}onClick(){}isSupported(){return ts(eV.isTouchEnabled)}autoSize(){this.state.supported&&(this.viewer.state.size.width<=this.mediaMinWidth&&this.state.visible?this.hide(!1):this.viewer.state.size.width>this.mediaMinWidth&&!this.state.visible&&this.show(!1))}__moveZoomValue(t){this.zoomValue.style.left=t/100*this.zoomRange.offsetWidth-this.zoomValue.offsetWidth/2+"px"}__onSliderUpdate(t){t.mousedown&&this.viewer.zoom(100*t.value)}};e7.id="zoomRange",e7.groupId="zoom";var e6=class extends tA{constructor(t){super(),this.viewer=t}init(){}destroy(){}},e9=class extends e6{constructor(t,e){super(t),this.config=this.constructor.configParser(e)}setOption(t,e){this.setOptions({[t]:e})}setOptions(t){let e={...this.config,...t},i=this.constructor,s=i.configParser,o=i.readonlyOptions,n=i.id;for(let[i,a]of Object.entries(t)){if(!(i in s.defaults)){ta(`${n}: Unknown option "${i}"`);continue}if(o.includes(i)){ta(`${n}: Option "${i}" cannot be updated`);continue}i in s.parsers&&(a=s.parsers[i](a,{rawConfig:e,defValue:s.defaults[i]})),this.config[i]=a}}};function it(t){if(t){for(let[,e]of[["_",t],...Object.entries(t)])if(e.prototype instanceof e6)return tx(e.id,e.VERSION,"5.14.0"),e}return null}e9.readonlyOptions=[];var ie={panorama:null,container:null,adapter:[eW,null],plugins:[],caption:null,description:null,downloadUrl:null,downloadName:null,loadingImg:null,loadingTxt:"",size:null,fisheye:0,minFov:30,maxFov:90,defaultZoomLvl:50,defaultYaw:0,defaultPitch:0,sphereCorrection:null,moveSpeed:1,zoomSpeed:1,moveInertia:.8,mousewheel:!0,mousemove:!0,mousewheelCtrlKey:!1,touchmoveTwoFingers:!1,panoData:null,requestHeaders:null,canvasBackground:"#000",defaultTransition:{speed:1500,rotation:!0,effect:"fade"},rendererParameters:{alpha:!0,antialias:!0},withCredentials:()=>!1,navbar:["zoom","move","download","description","caption","fullscreen"],lang:{zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",moveUp:"Move up",moveDown:"Move down",moveLeft:"Move left",moveRight:"Move right",description:"Description",download:"Download",fullscreen:"Fullscreen",loading:"Loading...",menu:"Menu",close:"Close",twoFingers:"Use two fingers to navigate",ctrlZoom:"Use ctrl + scroll to zoom the image",loadError:"The panorama cannot be loaded",webglError:"Your browser does not seem to support WebGL"},keyboard:"fullscreen",keyboardActions:{[b.ArrowUp]:"ROTATE_UP",[b.ArrowDown]:"ROTATE_DOWN",[b.ArrowRight]:"ROTATE_RIGHT",[b.ArrowLeft]:"ROTATE_LEFT",[b.PageUp]:"ZOOM_IN",[b.PageDown]:"ZOOM_OUT",[b.Plus]:"ZOOM_IN",[b.Minus]:"ZOOM_OUT"}},ii={panorama:"Use setPanorama method to change the panorama",panoData:"Use setPanorama method to change the panorama",container:"Cannot change viewer container",adapter:"Cannot change adapter",plugins:"Cannot change plugins"},is={container:t=>{if(!t)throw new te("No value given for container.");return t},adapter:(t,{defValue:e})=>{if(!(t=t?Array.isArray(t)?[eN(t[0]),t[1]]:[eN(t),null]:e)[0])throw new te("An undefined value was given for adapter.");if(!t[0].id)throw new te("Adapter has no id.");return t},defaultYaw:t=>ty(t),defaultPitch:t=>ty(t,!0),defaultZoomLvl:t=>o.cj9.clamp(t,0,100),minFov:(t,{rawConfig:e})=>(e.maxFov<t&&(ta("maxFov cannot be lower than minFov"),t=e.maxFov),o.cj9.clamp(t,1,179)),maxFov:(t,{rawConfig:e})=>(t<e.minFov&&(t=e.minFov),o.cj9.clamp(t,1,179)),moveInertia:(t,{defValue:e})=>!0===t?e:!1===t?0:t,lang:t=>({...ie.lang,...t}),fisheye:t=>!0===t?1:!1===t?0:t,requestHeaders:t=>t&&"object"==typeof t?()=>t:"function"==typeof t?t:null,withCredentials:t=>"boolean"==typeof t?()=>t:"function"==typeof t?t:()=>!1,defaultTransition:(t,{defValue:e})=>null===t||0===t.speed?null:{...e,...t},rendererParameters:(t,{defValue:e})=>({...t,...e}),plugins:t=>t.map((t,e)=>{if(!(t=Array.isArray(t)?[it(t[0]),t[1]]:[it(t),null])[0])throw new te(`An undefined value was given for plugin ${e}.`);if(!t[0].id)throw new te(`Plugin ${e} has no id.`);return t}),navbar:t=>!1===t?null:!0===t?K(ie.navbar):"string"==typeof t?t.split(/[ ,]/):t},io=tT(ie,is),ia=class extends eZ{constructor(t){super(t,{className:"psv-caption",hoverScale:!1,collapsable:!1,tabbable:!0}),this.contentWidth=0,this.state.width=0,this.contentElt=document.createElement("div"),this.contentElt.className="psv-caption-content",this.container.appendChild(this.contentElt),this.setCaption(this.viewer.config.caption)}hide(){this.contentElt.style.display="none",this.state.visible=!1}show(){this.contentElt.style.display="",this.state.visible=!0}onClick(){}setCaption(t){this.show(),this.contentElt.innerHTML=t??"",this.contentElt.innerHTML?this.contentWidth=this.contentElt.offsetWidth:this.contentWidth=0,this.autoSize()}autoSize(){this.toggle(this.container.offsetWidth>=this.contentWidth),this.__refreshButton()}__refreshButton(){this.viewer.navbar.getButton(eq.id,!1)?.autoSize(!0)}};ia.id="caption";var ir={},ih={};function il(t,e){if(!t.id)throw new te("Button id is required");if(ir[t.id]=t,t.groupId&&(ih[t.groupId]=ih[t.groupId]||[]).push(t),e){let i=ie.navbar;switch(e){case"start":i.unshift(t.id);break;case"end":i.push(t.id);break;default:{let[s,o]=e.split(":"),n=i.indexOf(s);if(!s||!o||-1===n)throw new te(`Invalid defaultPosition ${e}`);i.splice(n+ +("right"===o),0,t.id)}}}}[e8,e7,e4,eq,ia,eK,eG,e1,e2,e3,e0].forEach(t=>il(t));var ic=class extends e${constructor(t){super(t,{className:`psv-navbar ${f}`}),this.collapsed=[],this.state.visible=!1}show(){this.viewer.container.classList.add("psv--has-navbar"),this.container.classList.add("psv-navbar--open"),this.state.visible=!0}hide(){this.viewer.container.classList.remove("psv--has-navbar"),this.container.classList.remove("psv-navbar--open"),this.state.visible=!1}setButtons(t){this.children.slice().forEach(t=>t.destroy()),this.children.length=0,-1!==t.indexOf(ia.id)&&-1===t.indexOf(eq.id)&&t.splice(t.indexOf(ia.id),0,eq.id),t.forEach(t=>{"object"==typeof t?new eB(this,t):ir[t]?new ir[t](this):ih[t]?ih[t].forEach(t=>{new t(this)}):ta(`Unknown button ${t}`)}),new eQ(this),this.children.forEach(t=>{t instanceof eZ&&t.checkSupported()}),this.autoSize()}setCaption(t){this.children.some(e=>e instanceof ia&&(e.setCaption(t),!0))}getButton(t,e=!0){let i=this.children.find(e=>e instanceof eZ&&e.id===t);return!i&&e&&ta(`button "${t}" not found in the navbar`),i}focusButton(t){this.isVisible()&&(this.getButton(t,!1)?.container||this.container.firstElementChild)?.focus()}autoSize(){this.children.forEach(t=>{t instanceof eZ&&t.autoSize()});let t=this.container.offsetWidth,e=0,i=[];this.children.forEach(t=>{t.isVisible()&&t instanceof eZ&&(e+=t.width,t.collapsable&&i.push(t))}),0!==e&&(t<e&&i.length>0?(i.forEach(t=>t.collapse()),this.collapsed=i,this.getButton(eQ.id).show(!1)):t>=e&&this.collapsed.length>0&&(this.collapsed.forEach(t=>t.uncollapse()),this.collapsed=[],this.getButton(eQ.id).hide(!1)),this.getButton(ia.id,!1)?.autoSize())}};o.l2R.enabled=!1;var id={enabled:!0,maxItems:10,ttl:600,items:{},purgeInterval:null,init(){o.l2R.enabled&&(ta("ThreeJS cache should be disabled"),o.l2R.enabled=!1),!this.purgeInterval&&this.enabled&&(this.purgeInterval=setInterval(()=>this.purge(),6e4))},add(t,e,i){this.enabled&&e&&(this.items[e]=this.items[e]??{files:{},lastAccess:null},this.items[e].files[t]=i,this.items[e].lastAccess=Date.now())},get(t,e){if(this.enabled&&e&&this.items[e])return this.items[e].lastAccess=Date.now(),this.items[e].files[t]},remove(t,e){this.enabled&&e&&this.items[e]&&(delete this.items[e].files[t],0===Object.keys(this.items[e].files).length&&delete this.items[e])},purge(){Object.entries(this.items).sort(([,t],[,e])=>e.lastAccess-t.lastAccess).forEach(([t,{lastAccess:e}],i)=>{i>0&&(Date.now()-e>=1e3*this.ttl||i>=this.maxItems)&&delete this.items[t]})}},iu=class extends e${constructor(t){super(t,{className:"psv-loader-container"}),this.loader=document.createElement("div"),this.loader.className="psv-loader",this.container.appendChild(this.loader),this.size=this.loader.offsetWidth,this.canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.canvas.setAttribute("class","psv-loader-canvas"),this.canvas.setAttribute("viewBox",`0 0 ${this.size} ${this.size}`),this.loader.appendChild(this.canvas),this.textColor=V(this.loader,"color"),this.color=V(this.canvas,"color"),this.border=parseInt(V(this.loader,"--psv-loader-border"),10),this.thickness=parseInt(V(this.loader,"--psv-loader-tickness"),10);let e=this.size/2;this.canvas.innerHTML=`
            <circle cx="${e}" cy="${e}" r="${e}" fill="${this.color}"/>
            <path d="" fill="none" stroke="${this.textColor}" stroke-width="${this.thickness}" stroke-linecap="round"/>
        `,this.viewer.addEventListener(tZ.type,this),this.__updateContent(),this.hide()}destroy(){this.viewer.removeEventListener(tZ.type,this),super.destroy()}handleEvent(t){t instanceof tZ&&t.containsOptions("loadingImg","loadingTxt","lang")&&this.__updateContent()}setProgress(t){this.container.classList.remove("psv-loader--undefined");let e=o.cj9.clamp(t,0,99.999)/100*Math.PI*2,i=this.size/2,s=this.thickness/2+this.border,n=(this.size-this.thickness)/2-this.border,a=Math.sin(e)*n+i,r=-Math.cos(e)*n+i,h=t>50?"1":"0";this.canvas.querySelector("path").setAttributeNS(null,"d",`M ${i} ${s} A ${n} ${n} 0 ${h} 1 ${a} ${r}`)}showUndefined(){this.show(),this.setProgress(25),this.container.classList.add("psv-loader--undefined")}__updateContent(){let t,e=this.loader.querySelector(".psv-loader-image, .psv-loader-text");if(e&&this.loader.removeChild(e),this.viewer.config.loadingImg?((t=document.createElement("img")).className="psv-loader-image",t.src=this.viewer.config.loadingImg):null!==this.viewer.config.loadingTxt&&((t=document.createElement("div")).className="psv-loader-text",t.innerHTML=this.viewer.config.loadingTxt||this.viewer.config.lang.loading),t){let e=Math.round(Math.sqrt(2*Math.pow(this.size/2-this.thickness/2-this.border,2)));t.style.maxWidth=e+"px",t.style.maxHeight=e+"px",this.loader.appendChild(t)}}},ip=class extends e${constructor(t){super(t,{className:"psv-notification"}),this.state={visible:!1,contentId:null,timeout:null},this.content=document.createElement("div"),this.content.className="psv-notification-content",this.container.appendChild(this.content),this.content.addEventListener("click",()=>this.hide())}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new te("Notification cannot be toggled")}show(t){this.state.timeout&&(clearTimeout(this.state.timeout),this.state.timeout=null),"string"==typeof t&&(t={content:t}),this.state.contentId=t.id||null,this.content.innerHTML=t.content,this.container.classList.add("psv-notification--visible"),this.state.visible=!0,this.viewer.dispatchEvent(new ef(this.state.contentId)),t.timeout&&(this.state.timeout=setTimeout(()=>this.hide(this.state.contentId),t.timeout))}hide(t){if(this.isVisible(t)){let t=this.state.contentId;this.container.classList.remove("psv-notification--visible"),this.state.visible=!1,this.state.contentId=null,this.viewer.dispatchEvent(new tJ(t))}}},iv=class extends e${constructor(t){super(t,{className:`psv-overlay ${f}`}),this.state={visible:!1,contentId:null,dismissible:!0},this.image=document.createElement("div"),this.image.className="psv-overlay-image",this.container.appendChild(this.image),this.title=document.createElement("div"),this.title.className="psv-overlay-title",this.container.appendChild(this.title),this.text=document.createElement("div"),this.text.className="psv-overlay-text",this.container.appendChild(this.text),this.container.addEventListener("click",this),this.viewer.addEventListener(t7.type,this),super.hide()}destroy(){this.viewer.removeEventListener(t7.type,this),super.destroy()}handleEvent(t){"click"===t.type?this.isVisible()&&this.state.dismissible&&(this.hide(),t.stopPropagation()):t instanceof t7&&this.isVisible()&&this.state.dismissible&&t.matches(b.Escape)&&(this.hide(),t.preventDefault())}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new te("Overlay cannot be toggled")}show(t){"string"==typeof t&&(t={title:t}),this.state.contentId=t.id||null,this.state.dismissible=!1!==t.dismissible,this.image.innerHTML=t.image||"",this.title.innerHTML=t.title||"",this.text.innerHTML=t.text||"",super.show(),this.viewer.dispatchEvent(new ey(this.state.contentId))}hide(t){if(this.isVisible(t)){let t=this.state.contentId;super.hide(),this.state.contentId=null,this.viewer.dispatchEvent(new t1(t))}}},im="psv-panel-content--no-interaction",iw=class extends e${constructor(t){super(t,{className:`psv-panel ${f}`}),this.state={visible:!1,contentId:null,mouseX:0,mouseY:0,mousedown:!1,clickHandler:null,keyHandler:null,width:{}};let e=document.createElement("div");e.className="psv-panel-resizer",this.container.appendChild(e);let i=document.createElement("div");i.className="psv-panel-close-button",i.innerHTML=E.close,i.title=t.config.lang.close,this.container.appendChild(i),this.content=document.createElement("div"),this.content.className="psv-panel-content",this.container.appendChild(this.content),i.addEventListener("click",()=>this.hide()),e.addEventListener("mousedown",this),e.addEventListener("touchstart",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this),this.viewer.container.addEventListener("mousemove",this),this.viewer.container.addEventListener("touchmove",this),this.viewer.addEventListener(t7.type,this)}destroy(){this.viewer.removeEventListener(t7.type,this),this.viewer.container.removeEventListener("mousemove",this),this.viewer.container.removeEventListener("touchmove",this),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown(t);break;case"touchstart":this.__onTouchStart(t);break;case"mousemove":this.__onMouseMove(t);break;case"touchmove":this.__onTouchMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchend":this.__onTouchEnd(t);break;case t7.type:this.__onKeyPress(t)}}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new te("Panel cannot be toggled")}show(t){"string"==typeof t&&(t={content:t});let e=this.isVisible(t.id);this.state.contentId=t.id||null,this.state.visible=!0,this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),t.id&&this.state.width[t.id]?this.container.style.width=this.state.width[t.id]:t.width?this.container.style.width=t.width:this.container.style.width=null,this.content.innerHTML=t.content,this.content.scrollTop=0,this.container.classList.add("psv-panel--open"),S(this.content,"psv-panel-content--no-margin",!0===t.noMargin),t.clickHandler&&(this.state.clickHandler=e=>{t.clickHandler(R(e))},this.state.keyHandler=e=>{e.key===b.Enter&&t.clickHandler(R(e))},this.content.addEventListener("click",this.state.clickHandler),this.content.addEventListener("keydown",this.state.keyHandler),e||setTimeout(()=>{this.content.querySelector("a,button,[tabindex]")?.focus()},300)),this.viewer.dispatchEvent(new eE(this.state.contentId))}hide(t){if(this.isVisible(t)){let t=this.state.contentId;this.state.visible=!1,this.state.contentId=null,this.content.innerHTML=null,this.container.classList.remove("psv-panel--open"),this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),this.viewer.dispatchEvent(new t3(t))}}__onMouseDown(t){t.stopPropagation(),this.__startResize(t.clientX,t.clientY)}__onTouchStart(t){if(t.stopPropagation(),1===t.touches.length){let e=t.touches[0];this.__startResize(e.clientX,e.clientY)}}__onMouseUp(t){this.state.mousedown&&(t.stopPropagation(),this.state.mousedown=!1,this.content.classList.remove(im))}__onTouchEnd(t){this.state.mousedown&&(t.stopPropagation(),0===t.touches.length&&(this.state.mousedown=!1,this.content.classList.remove(im)))}__onMouseMove(t){this.state.mousedown&&(t.stopPropagation(),this.__resize(t.clientX,t.clientY))}__onTouchMove(t){if(this.state.mousedown){let e=t.touches[0];this.__resize(e.clientX,e.clientY)}}__onKeyPress(t){this.isVisible()&&t.matches(b.Escape)&&(this.hide(),t.preventDefault())}__startResize(t,e){this.state.mouseX=t,this.state.mouseY=e,this.state.mousedown=!0,this.content.classList.add(im)}__resize(t,e){let i=Math.max(200,this.container.offsetWidth-(t-this.state.mouseX))+"px";this.state.contentId&&(this.state.width[this.state.contentId]=i),this.container.style.width=i,this.state.mouseX=t,this.state.mouseY=e}},ig=class extends e${constructor(t,e){super(t,{className:"psv-tooltip"}),this.state={visible:!0,arrow:0,border:0,state:0,width:0,height:0,pos:"",config:null,data:null,hideTimeout:null},this.content=document.createElement("div"),this.content.className="psv-tooltip-content",this.container.appendChild(this.content),this.arrow=document.createElement("div"),this.arrow.className="psv-tooltip-arrow",this.container.appendChild(this.arrow),this.container.addEventListener("transitionend",this),this.container.addEventListener("touchdown",t=>t.stopPropagation()),this.container.addEventListener("mousedown",t=>t.stopPropagation()),this.container.style.top="-1000px",this.container.style.left="-1000px",this.show(e)}handleEvent(t){"transitionend"===t.type&&this.__onTransitionEnd(t)}destroy(){clearTimeout(this.state.hideTimeout),delete this.state.data,super.destroy()}toggle(){throw new te("Tooltip cannot be toggled")}show(t){if(0!==this.state.state)throw new te("Initialized tooltip cannot be re-initialized");t.className&&z(this.container,t.className),t.style&&Object.assign(this.container.style,t.style),this.state.state=3,this.update(t.content,t),this.state.data=t.data,this.state.state=1,this.viewer.dispatchEvent(new eT(this,this.state.data)),this.__waitImages()}update(t,e){this.content.innerHTML=t;let i=this.container.getBoundingClientRect();this.state.width=i.right-i.left,this.state.height=i.bottom-i.top,this.state.arrow=parseInt(V(this.arrow,"border-top-width"),10),this.state.border=parseInt(V(this.container,"border-top-left-radius"),10),this.move(e??this.state.config),this.__waitImages()}move(t){if(1!==this.state.state&&3!==this.state.state)throw new te("Uninitialized tooltip cannot be moved");t.box=t.box??this.state.config?.box??{width:0,height:0},this.state.config=t;let e=this.container,i=this.arrow,s={posClass:tm(t.position,{allowCenter:!1,cssOrder:!1})||["top","center"],width:this.state.width,height:this.state.height,top:0,left:0,arrowTop:0,arrowLeft:0};this.__computeTooltipPosition(s,t);let o=null,n=null;if(s.top<0?o="bottom":s.top+s.height>this.viewer.state.size.height&&(o="top"),s.left<0?n="right":s.left+s.width>this.viewer.state.size.width&&(n="left"),n||o){let e=tw(s.posClass);o&&(s.posClass[+!e]=o),n&&(s.posClass[+!!e]=n),this.__computeTooltipPosition(s,t)}e.style.top=s.top+"px",e.style.left=s.left+"px",i.style.top=s.arrowTop+"px",i.style.left=s.arrowLeft+"px";let a=s.posClass.join("-");a!==this.state.pos&&(e.classList.remove(`psv-tooltip--${this.state.pos}`),this.state.pos=a,e.classList.add(`psv-tooltip--${this.state.pos}`))}hide(){this.container.classList.remove("psv-tooltip--visible"),this.state.state=2,this.viewer.dispatchEvent(new t4(this.state.data));let t=parseFloat(V(this.container,"transition-duration"));this.state.hideTimeout=setTimeout(()=>{this.destroy()},2*t)}__onTransitionEnd(t){if("transform"===t.propertyName)switch(this.state.state){case 1:this.container.classList.add("psv-tooltip--visible"),this.state.state=3;break;case 2:this.state.state=0,this.destroy()}}__computeTooltipPosition(t,e){let i=this.state.arrow,s=e.top,o=t.height,n=e.left,a=t.width,r=i+this.state.border,h=e.box.width/2+2*i,l=e.box.height/2+2*i;switch(t.posClass.join("-")){case"top-left":t.top=s-l-o,t.left=n+r-a,t.arrowTop=o,t.arrowLeft=a-r-i;break;case"top-center":t.top=s-l-o,t.left=n-a/2,t.arrowTop=o,t.arrowLeft=a/2-i;break;case"top-right":t.top=s-l-o,t.left=n-r,t.arrowTop=o,t.arrowLeft=i;break;case"bottom-left":t.top=s+l,t.left=n+r-a,t.arrowTop=-(2*i),t.arrowLeft=a-r-i;break;case"bottom-center":t.top=s+l,t.left=n-a/2,t.arrowTop=-(2*i),t.arrowLeft=a/2-i;break;case"bottom-right":t.top=s+l,t.left=n-r,t.arrowTop=-(2*i),t.arrowLeft=i;break;case"left-top":t.top=s+r-o,t.left=n-h-a,t.arrowTop=o-r-i,t.arrowLeft=a;break;case"center-left":t.top=s-o/2,t.left=n-h-a,t.arrowTop=o/2-i,t.arrowLeft=a;break;case"left-bottom":t.top=s-r,t.left=n-h-a,t.arrowTop=i,t.arrowLeft=a;break;case"right-top":t.top=s+r-o,t.left=n+h,t.arrowTop=o-r-i,t.arrowLeft=-(2*i);break;case"center-right":t.top=s-o/2,t.left=n+h,t.arrowTop=o/2-i,t.arrowLeft=-(2*i);break;case"right-bottom":t.top=s-r,t.left=n+h,t.arrowTop=i,t.arrowLeft=-(2*i)}}__waitImages(){let t=this.content.querySelectorAll("img");if(t.length>0){let e=[];t.forEach(t=>{t.complete||e.push(new Promise(e=>{t.onload=e,t.onerror=e}))}),e.length&&Promise.all(e).then(()=>{if(1===this.state.state||3===this.state.state){let t=this.container.getBoundingClientRect();this.state.width=t.right-t.left,this.state.height=t.bottom-t.top,this.move(this.state.config)}})}}},iy=class{constructor(t){this.viewer=t,this.config=t.config,this.state=t.state}destroy(){}},ib=new o.Pq0,iE=new o.O9p(0,0,0,"ZXY"),i_=class extends iy{constructor(t){super(t)}fovToZoomLevel(t){let e=Math.round((t-this.config.minFov)/(this.config.maxFov-this.config.minFov)*100);return o.cj9.clamp(e-2*(e-50),0,100)}zoomLevelToFov(t){return this.config.maxFov+t/100*(this.config.minFov-this.config.maxFov)}vFovToHFov(t){return o.cj9.radToDeg(2*Math.atan(Math.tan(o.cj9.degToRad(t)/2)*this.state.aspect))}hFovToVFov(t){return o.cj9.radToDeg(2*Math.atan(Math.tan(o.cj9.degToRad(t)/2)/this.state.aspect))}getAnimationProperties(t,e,i){let s=!Q(e),o=!Q(i),n={},a=null;if(s){let i=this.viewer.getPosition(),s=P(i.yaw,e.yaw);n.yaw={start:i.yaw,end:i.yaw+s},n.pitch={start:i.pitch,end:e.pitch},a=tg(t,O(i,e))}if(o){let e=this.viewer.getZoomLevel(),s=Math.abs(i-e);n.zoom={start:e,end:i},null===a&&(a=tg(t,Math.PI/4*s/100))}return{duration:a=null===a?"number"==typeof t?t:l:Math.max(l,a),properties:n}}getTransitionOptions(t){let e=this.config.defaultTransition??ie.defaultTransition;return!1===t.transition||null===t.transition?null:!0===t.transition?{...e}:"object"==typeof t.transition?{...e,...t.transition}:this.config.defaultTransition}textureCoordsToSphericalCoords(t){if(!this.state.textureData?.panoData)throw new te("Current adapter does not support texture coordinates or no texture has been loaded");let e=this.viewer.adapter.textureCoordsToSphericalCoords(t,this.state.textureData.panoData);return iE.equals(this.viewer.renderer.panoramaPose)&&iE.equals(this.viewer.renderer.sphereCorrection)?e:(this.sphericalCoordsToVector3(e,ib),ib.applyEuler(this.viewer.renderer.panoramaPose),ib.applyEuler(this.viewer.renderer.sphereCorrection),this.vector3ToSphericalCoords(ib))}sphericalCoordsToTextureCoords(t){if(!this.state.textureData?.panoData)throw new te("Current adapter does not support texture coordinates or no texture has been loaded");return iE.equals(this.viewer.renderer.panoramaPose)&&iE.equals(this.viewer.renderer.sphereCorrection)||(this.sphericalCoordsToVector3(t,ib),t_(ib,this.viewer.renderer.sphereCorrection),t_(ib,this.viewer.renderer.panoramaPose),t=this.vector3ToSphericalCoords(ib)),this.viewer.adapter.sphericalCoordsToTextureCoords(t,this.state.textureData.panoData)}sphericalCoordsToVector3(t,e,i=m){return e||(e=new o.Pq0),e.x=-(i*Math.cos(t.pitch))*Math.sin(t.yaw),e.y=i*Math.sin(t.pitch),e.z=i*Math.cos(t.pitch)*Math.cos(t.yaw),e}vector3ToSphericalCoords(t){let e=Math.acos(t.y/Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)),i=Math.atan2(t.x,t.z);return{yaw:i<0?-i:2*Math.PI-i,pitch:Math.PI/2-e}}viewerCoordsToVector3(t){let e=this.viewer.renderer.getIntersections(t).filter(t=>t.object.userData[w]);return e.length?e[0].point:null}viewerCoordsToSphericalCoords(t){let e=this.viewerCoordsToVector3(t);return e?this.vector3ToSphericalCoords(e):null}vector3ToViewerCoords(t){let e=t.clone();return e.project(this.viewer.renderer.camera),{x:Math.round((e.x+1)/2*this.state.size.width),y:Math.round((1-e.y)/2*this.state.size.height)}}sphericalCoordsToViewerCoords(t){return this.sphericalCoordsToVector3(t,ib),this.vector3ToViewerCoords(ib)}isPointVisible(t){let e,i;if(t instanceof o.Pq0)e=t,i=this.vector3ToViewerCoords(t);else{if(!tr(t))return!1;e=this.sphericalCoordsToVector3(t,ib),i=this.vector3ToViewerCoords(e)}return e.dot(this.viewer.state.direction)>0&&i.x>=0&&i.x<=this.viewer.state.size.width&&i.y>=0&&i.y<=this.viewer.state.size.height}cleanPosition(t){if(!("yaw"in t)&&!("pitch"in t))return this.textureCoordsToSphericalCoords(t);if(!("yaw"in t)||!("pitch"in t))throw new te("Position is missing 'yaw' or 'pitch'");return{yaw:ty(t.yaw),pitch:ty(t.pitch,!0)}}cleanSphereCorrection(t){return{pan:ty(t?.pan||0),tilt:ty(t?.tilt||0,!0),roll:ty(t?.roll||0,!0,!1)}}cleanPanoramaPose(t){return{pan:o.cj9.degToRad(t?.poseHeading||0),tilt:o.cj9.degToRad(t?.posePitch||0),roll:o.cj9.degToRad(t?.poseRoll||0)}}cleanPanoramaOptions(t,e){return e?.isEquirectangular&&(Q(t.zoom)&&!Q(e.initialFov)&&(t={...t,zoom:this.fovToZoomLevel(this.hFovToVFov(e.initialFov))}),!Q(t.position)||Q(e.initialHeading)||Q(e.initialPitch)||(t={...t,position:{yaw:ty(e.initialHeading),pitch:ty(e.initialPitch,!0)}})),t}},iT=class t{constructor(){this.$=t.IDLE}is(...t){return t.some(t=>this.$&t)}set(t){this.$=t}add(t){this.$|=t}remove(t){this.$&=~t}};iT.IDLE=0,iT.CLICK=1,iT.MOVING=2;var iM=class extends iy{constructor(t){super(t),this.data={startMouseX:0,startMouseY:0,mouseX:0,mouseY:0,pinchDist:0,moveDelta:{yaw:0,pitch:0,zoom:0},accumulatorFactor:0,ctrlKeyDown:!1,dblclickData:null,dblclickTimeout:null,longtouchTimeout:null,twofingersTimeout:null,ctrlZoomTimeout:null},this.step=new iT,this.keyHandler=new tI,this.resizeObserver=new ResizeObserver(Z(()=>this.viewer.autoSize(),50)),this.moveThreshold=c*eV.pixelRatio}init(){window.addEventListener("keydown",this,{passive:!1}),window.addEventListener("keyup",this),this.viewer.container.addEventListener("mousedown",this),window.addEventListener("mousemove",this,{passive:!1}),window.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchstart",this,{passive:!1}),window.addEventListener("touchmove",this,{passive:!1}),window.addEventListener("touchend",this,{passive:!1}),this.viewer.container.addEventListener("wheel",this,{passive:!1}),document.addEventListener("fullscreenchange",this),this.resizeObserver.observe(this.viewer.container),this.viewer.addEventListener(tF.type,this),this.viewer.addEventListener(eC.type,this)}destroy(){window.removeEventListener("keydown",this),window.removeEventListener("keyup",this),this.viewer.container.removeEventListener("mousedown",this),window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchstart",this),window.removeEventListener("touchmove",this),window.removeEventListener("touchend",this),this.viewer.container.removeEventListener("wheel",this),document.removeEventListener("fullscreenchange",this),this.resizeObserver.disconnect(),this.viewer.removeEventListener(tF.type,this),this.viewer.removeEventListener(eC.type,this),clearTimeout(this.data.dblclickTimeout),clearTimeout(this.data.longtouchTimeout),clearTimeout(this.data.twofingersTimeout),clearTimeout(this.data.ctrlZoomTimeout),super.destroy()}handleEvent(t){switch(t.type){case"keydown":this.__onKeyDown(t);break;case"keyup":this.__onKeyUp();break;case"mousemove":this.__onMouseMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchmove":this.__onTouchMove(t);break;case"touchend":this.__onTouchEnd(t);break;case"fullscreenchange":this.__onFullscreenChange();break;case tF.type:this.__applyMoveDelta();break;case eC.type:this.__clearMoveDelta()}if(!N(t,"."+f))switch(t.type){case"mousedown":this.__onMouseDown(t);break;case"touchstart":this.__onTouchStart(t);break;case"wheel":this.__onMouseWheel(t)}}__onKeyDown(t){if((this.config.mousewheelCtrlKey&&(this.data.ctrlKeyDown=t.key===b.Control,this.data.ctrlKeyDown&&(clearTimeout(this.data.ctrlZoomTimeout),this.viewer.overlay.hide(y.CTRL_ZOOM))),this.viewer.dispatchEvent(new t7(t.key,t)))&&this.state.keyboardEnabled&&this.config.keyboardActions&&!this.keyHandler.pending){for(let[e,i]of Object.entries(this.config.keyboardActions))if($(t,e)){if("function"==typeof i)i(this.viewer,t);else{switch("ZOOM_IN"!==i&&"ZOOM_OUT"!==i&&this.viewer.stopAll(),i){case"ROTATE_UP":this.viewer.dynamics.position.roll({pitch:!1});break;case"ROTATE_DOWN":this.viewer.dynamics.position.roll({pitch:!0});break;case"ROTATE_RIGHT":this.viewer.dynamics.position.roll({yaw:!1});break;case"ROTATE_LEFT":this.viewer.dynamics.position.roll({yaw:!0});break;case"ZOOM_IN":this.viewer.dynamics.zoom.roll(!1);break;case"ZOOM_OUT":this.viewer.dynamics.zoom.roll(!0)}this.keyHandler.down(i)}t.preventDefault();return}}}__onKeyUp(){this.data.ctrlKeyDown=!1,this.state.keyboardEnabled&&this.keyHandler.up(t=>{"ZOOM_IN"===t||"ZOOM_OUT"===t?this.viewer.dynamics.zoom.stop():(this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer())})}__onMouseDown(t){this.step.add(iT.CLICK),this.data.startMouseX=t.clientX,this.data.startMouseY=t.clientY,this.config.mousemove&&t.preventDefault()}__onMouseUp(t){this.step.is(iT.CLICK,iT.MOVING)&&this.__stopMove(t.clientX,t.clientY,t,2===t.button)}__onMouseMove(t){this.config.mousemove&&this.step.is(iT.CLICK,iT.MOVING)&&(t.preventDefault(),this.__doMove(t.clientX,t.clientY)),this.__handleObjectsEvents(t)}__onTouchStart(t){1===t.touches.length?(this.step.add(iT.CLICK),this.data.startMouseX=t.touches[0].clientX,this.data.startMouseY=t.touches[0].clientY,this.data.longtouchTimeout||(this.data.longtouchTimeout=setTimeout(()=>{let e=t.touches[0];this.__stopMove(e.clientX,e.clientY,t,!0),this.data.longtouchTimeout=null},u))):2===t.touches.length&&(this.step.set(iT.IDLE),this.__cancelLongTouch(),this.config.mousemove&&(this.__cancelTwoFingersOverlay(),this.__startMoveZoom(t),t.preventDefault()))}__onTouchEnd(t){if(this.__cancelLongTouch(),this.step.is(iT.CLICK,iT.MOVING)){if(t.preventDefault(),this.__cancelTwoFingersOverlay(),1===t.touches.length)this.__stopMove(this.data.mouseX,this.data.mouseY);else if(0===t.touches.length){let e=t.changedTouches[0];this.__stopMove(e.clientX,e.clientY,t)}}}__onTouchMove(t){if(this.__cancelLongTouch(),this.config.mousemove)if(1===t.touches.length){if(this.config.touchmoveTwoFingers)this.step.is(iT.CLICK)&&!this.data.twofingersTimeout&&(this.data.twofingersTimeout=setTimeout(()=>{this.viewer.overlay.show({id:y.TWO_FINGERS,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M33.38 33.2a1.96 1.96 0 0 0 1.5-3.23 10.61 10.61 0 0 1 7.18-17.51c.7-.06 1.31-.49 1.61-1.12a13.02 13.02 0 0 1 11.74-7.43c7.14 0 12.96 5.8 12.96 12.9 0 3.07-1.1 6.05-3.1 8.38-.7.82-.61 2.05.21 2.76.83.7 2.07.6 2.78-.22a16.77 16.77 0 0 0 4.04-10.91C72.3 7.54 64.72 0 55.4 0a16.98 16.98 0 0 0-14.79 8.7 14.6 14.6 0 0 0-12.23 14.36c0 3.46 1.25 6.82 3.5 9.45.4.45.94.69 1.5.69m45.74 43.55a22.13 22.13 0 0 1-5.23 12.4c-4 4.55-9.53 6.86-16.42 6.86-12.6 0-20.1-10.8-20.17-10.91a1.82 1.82 0 0 0-.08-.1c-5.3-6.83-14.55-23.82-17.27-28.87-.05-.1 0-.21.02-.23a6.3 6.3 0 0 1 8.24 1.85l9.38 12.59a1.97 1.97 0 0 0 3.54-1.17V25.34a4 4 0 0 1 1.19-2.87 3.32 3.32 0 0 1 2.4-.95c1.88.05 3.4 1.82 3.4 3.94v24.32a1.96 1.96 0 0 0 3.93 0v-33.1a3.5 3.5 0 0 1 7 0v35.39a1.96 1.96 0 0 0 3.93 0v-.44c.05-2.05 1.6-3.7 3.49-3.7 1.93 0 3.5 1.7 3.5 3.82v5.63c0 .24.04.48.13.71l.1.26a1.97 1.97 0 0 0 3.76-.37c.33-1.78 1.77-3.07 3.43-3.07 1.9 0 3.45 1.67 3.5 3.74l-1.77 18.1zM77.39 51c-1.25 0-2.45.32-3.5.9v-.15c0-4.27-3.33-7.74-7.42-7.74-1.26 0-2.45.33-3.5.9V16.69a7.42 7.42 0 0 0-14.85 0v1.86a7 7 0 0 0-3.28-.94 7.21 7.21 0 0 0-5.26 2.07 7.92 7.92 0 0 0-2.38 5.67v37.9l-5.83-7.82a10.2 10.2 0 0 0-13.35-2.92 4.1 4.1 0 0 0-1.53 5.48C20 64.52 28.74 80.45 34.07 87.34c.72 1.04 9.02 12.59 23.4 12.59 7.96 0 14.66-2.84 19.38-8.2a26.06 26.06 0 0 0 6.18-14.6l1.78-18.2v-.2c0-4.26-3.32-7.73-7.42-7.73z"/>\x3c!--Created by AomAm from the Noun Project--\x3e</svg>\n',title:this.config.lang.twoFingers})},p));else if(this.step.is(iT.CLICK,iT.MOVING)){t.preventDefault();let e=t.touches[0];this.__doMove(e.clientX,e.clientY)}}else this.__doMoveZoom(t),this.__cancelTwoFingersOverlay()}__cancelLongTouch(){this.data.longtouchTimeout&&(clearTimeout(this.data.longtouchTimeout),this.data.longtouchTimeout=null)}__cancelTwoFingersOverlay(){this.config.touchmoveTwoFingers&&(this.data.twofingersTimeout&&(clearTimeout(this.data.twofingersTimeout),this.data.twofingersTimeout=null),this.viewer.overlay.hide(y.TWO_FINGERS))}__onMouseWheel(t){if(!this.config.mousewheel||!t.deltaY)return;if(this.config.mousewheelCtrlKey&&!this.data.ctrlKeyDown){this.viewer.overlay.show({id:y.CTRL_ZOOM,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 17 79 79"><path fill="currentColor" d="M38.1 29.27c-.24 0-.44.2-.44.45v10.7a.45.45 0 00.9 0v-10.7c0-.25-.2-.45-.45-.45zm10.2 26.66a11.54 11.54 0 01-8.48-6.14.45.45 0 10-.8.41 12.45 12.45 0 009.22 6.62.45.45 0 00.07-.9zm24.55-13.08a23.04 23.04 0 00-22.56-23v7.07l-.01.05a2.83 2.83 0 012.39 2.78v14.03l.09-.02h8.84v-9.22a.45.45 0 11.9 0v9.22h10.35v-.9zm0 27.33V44.66H62.5c-.02 2.01-.52 4-1.47 5.76a.45.45 0 01-.61.18.45.45 0 01-.19-.61 11.54 11.54 0 001.36-5.33h-8.83l-.1-.01a2.83 2.83 0 01-2.83 2.84h-.04-.04a2.83 2.83 0 01-2.83-2.83v-14.9a2.82 2.82 0 012.47-2.8v-7.11a23.04 23.04 0 00-22.57 23v.91h14.72V29.88a8.2 8.2 0 015.02-7.57c.22-.1.5.01.59.24.1.23-.01.5-.24.6a7.3 7.3 0 00-4.47 6.73v13.88h3.9a.45.45 0 110 .9h-3.9v.15a7.32 7.32 0 0011.23 6.17.45.45 0 01.49.76 8.22 8.22 0 01-12.62-6.93v-.15H26.82v25.52a23.04 23.04 0 0023.01 23.01 23.04 23.04 0 0023.02-23.01zm1.8-27.33v27.33A24.85 24.85 0 0149.84 95a24.85 24.85 0 01-24.82-24.82V42.85a24.85 24.85 0 0124.82-24.82 24.85 24.85 0 0124.83 24.82zM57.98 29.88v9.36a.45.45 0 11-.9 0v-9.36a7.28 7.28 0 00-3.4-6.17.45.45 0 01.49-.76 8.18 8.18 0 013.8 6.93z"/>\x3c!-- Created by Icon Island from the Noun Project --\x3e</svg>\n',title:this.config.lang.ctrlZoom}),clearTimeout(this.data.ctrlZoomTimeout),this.data.ctrlZoomTimeout=setTimeout(()=>this.viewer.overlay.hide(y.CTRL_ZOOM),v);return}t.preventDefault(),t.stopPropagation();let e=t.deltaY/Math.abs(t.deltaY)*5*this.config.zoomSpeed;0!==e&&this.viewer.dynamics.zoom.step(-e,5)}__onFullscreenChange(){let t=this.viewer.isFullscreenEnabled();"fullscreen"===this.config.keyboard&&(t?this.viewer.startKeyboardControl():this.viewer.stopKeyboardControl()),this.viewer.dispatchEvent(new tG(t))}__resetMove(){this.step.set(iT.IDLE),this.data.mouseX=0,this.data.mouseY=0,this.data.startMouseX=0,this.data.startMouseY=0}__startMoveZoom(t){this.viewer.stopAll(),this.__resetMove();let e=F(t);this.step.set(iT.MOVING),this.data.accumulatorFactor=this.config.moveInertia,{distance:this.data.pinchDist,center:{x:this.data.mouseX,y:this.data.mouseY}}=e}__stopMove(t,e,i,s=!1){this.step.is(iT.CLICK)&&!this.__moveThresholdReached(t,e)&&this.__doClick(t,e,i,s),this.config.moveInertia&&(this.data.accumulatorFactor=Math.pow(this.config.moveInertia,.5)),this.__resetMove(),this.viewer.resetIdleTimer()}__doClick(t,e,i,s=!1){let o=this.viewer.container.getBoundingClientRect(),n=t-o.left,a=e-o.top,r=this.viewer.renderer.getIntersections({x:n,y:a}),h=r.find(t=>t.object.userData[w]);if(h){let o=this.viewer.dataHelper.vector3ToSphericalCoords(h.point),l={rightclick:s,originalEvent:i,target:R(i),clientX:t,clientY:e,viewerX:n,viewerY:a,yaw:o.yaw,pitch:o.pitch,objects:r.map(t=>t.object).filter(t=>!t.userData[w])};try{let t=this.viewer.dataHelper.sphericalCoordsToTextureCoords(l);Object.assign(l,t)}catch{}this.data.dblclickTimeout?(Math.abs(this.data.dblclickData.clientX-l.clientX)<this.moveThreshold&&Math.abs(this.data.dblclickData.clientY-l.clientY)<this.moveThreshold&&this.viewer.dispatchEvent(new tq(this.data.dblclickData)),clearTimeout(this.data.dblclickTimeout),this.data.dblclickTimeout=null,this.data.dblclickData=null):(this.viewer.dispatchEvent(new t$(l)),this.data.dblclickData=K(l),this.data.dblclickTimeout=setTimeout(()=>{this.data.dblclickTimeout=null,this.data.dblclickData=null},d))}}__handleObjectsEvents(t){if(!G(this.state.objectsObservers)&&t.composedPath().includes(this.viewer.container)){let e=j(this.viewer.container),i={x:t.clientX-e.x,y:t.clientY-e.y},s=this.viewer.renderer.getIntersections(i),o=(e,s,o)=>{this.viewer.dispatchEvent(new o(t,e,i,s))};for(let[t,e]of Object.entries(this.state.objectsObservers)){let i=s.find(e=>e.object.userData[t]);i?(e&&i.object!==e&&(o(e,t,eD),this.state.objectsObservers[t]=null),e?o(i.object,t,eA):(this.state.objectsObservers[t]=i.object,o(i.object,t,eS))):e&&(o(e,t,eD),this.state.objectsObservers[t]=null)}}}__doMove(t,e){if(this.step.is(iT.CLICK)&&this.__moveThresholdReached(t,e))this.viewer.stopAll(),this.__resetMove(),this.step.set(iT.MOVING),this.data.mouseX=t,this.data.mouseY=e,this.data.accumulatorFactor=this.config.moveInertia;else if(this.step.is(iT.MOVING)){let i=(t-this.data.mouseX)*Math.cos(this.state.roll)-(e-this.data.mouseY)*Math.sin(this.state.roll),s=(e-this.data.mouseY)*Math.cos(this.state.roll)+(t-this.data.mouseX)*Math.sin(this.state.roll),n={yaw:this.config.moveSpeed*(i/this.state.size.width)*o.cj9.degToRad(this.state.hFov),pitch:this.config.moveSpeed*(s/this.state.size.height)*o.cj9.degToRad(this.state.vFov)};this.data.moveDelta.yaw+=n.yaw,this.data.moveDelta.pitch+=n.pitch,this.data.mouseX=t,this.data.mouseY=e}}__moveThresholdReached(t,e){return Math.abs(t-this.data.startMouseX)>=this.moveThreshold||Math.abs(e-this.data.startMouseY)>=this.moveThreshold}__doMoveZoom(t){if(this.step.is(iT.MOVING)){t.preventDefault();let e=F(t);this.__doMove(e.center.x,e.center.y),this.data.moveDelta.zoom+=this.config.zoomSpeed*((e.distance-this.data.pinchDist)/eV.pixelRatio),this.data.pinchDist=e.distance}}__applyMoveDelta(){if(Math.abs(this.data.moveDelta.yaw)>0||Math.abs(this.data.moveDelta.pitch)>0){let t=this.viewer.getPosition();this.viewer.rotate({yaw:t.yaw-this.data.moveDelta.yaw*(1-this.config.moveInertia),pitch:t.pitch+this.data.moveDelta.pitch*(1-this.config.moveInertia)}),this.data.moveDelta.yaw*=this.data.accumulatorFactor,this.data.moveDelta.pitch*=this.data.accumulatorFactor,.001>=Math.abs(this.data.moveDelta.yaw)&&(this.data.moveDelta.yaw=0),.001>=Math.abs(this.data.moveDelta.pitch)&&(this.data.moveDelta.pitch=0)}if(Math.abs(this.data.moveDelta.zoom)>0){let t=this.viewer.getZoomLevel();this.viewer.zoom(t+this.data.moveDelta.zoom*(1-this.config.moveInertia)),this.data.moveDelta.zoom*=this.config.moveInertia,.001>=Math.abs(this.data.moveDelta.zoom)&&(this.data.moveDelta.zoom=0)}}__clearMoveDelta(){this.data.moveDelta.yaw=0,this.data.moveDelta.pitch=0,this.data.moveDelta.zoom=0}};o.ppV.enabled=!1;var ix=new o.I9Y,iL=new o.kn4,iC=new o.NRn,iP=class extends iy{constructor(t){super(t),this.frustumNeedsUpdate=!0,this.renderer=new n.JeP(this.config.rendererParameters),this.renderer.setPixelRatio(eV.pixelRatio),this.renderer.outputColorSpace=o.Zr2,this.renderer.toneMapping=o.kyO,this.renderer.domElement.className="psv-canvas",this.renderer.domElement.style.background=this.config.canvasBackground,this.scene=new o.Z58,this.camera=new o.ubm(50,16/9,.1,2*m),this.camera.matrixAutoUpdate=!1;let e=new o.eaF(new o.Gu$(m).scale(-1,1,1),new o.V9B({opacity:0,transparent:!0,depthTest:!1,depthWrite:!1}));e.userData={[w]:!0},this.scene.add(e),this.raycaster=new o.tBo,this.frustum=new o.PPD,this.container=document.createElement("div"),this.container.className="psv-canvas-container",this.container.appendChild(this.renderer.domElement),this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",t=>t.preventDefault()),this.viewer.addEventListener(ex.type,this),this.viewer.addEventListener(eO.type,this),this.viewer.addEventListener(el.type,this),this.viewer.addEventListener(ed.type,this),this.viewer.addEventListener(tZ.type,this),this.hide()}get panoramaPose(){return this.mesh.rotation}get sphereCorrection(){return this.meshContainer.rotation}init(){this.show(),this.renderer.setAnimationLoop(t=>this.__renderLoop(t))}destroy(){this.renderer.setAnimationLoop(null),this.cleanScene(this.scene),this.renderer.dispose(),this.viewer.container.removeChild(this.container),this.viewer.removeEventListener(ex.type,this),this.viewer.removeEventListener(eO.type,this),this.viewer.removeEventListener(el.type,this),this.viewer.removeEventListener(ed.type,this),this.viewer.removeEventListener(tZ.type,this),super.destroy()}handleEvent(t){switch(t.type){case ex.type:this.__onSizeUpdated();break;case eO.type:this.__onZoomUpdated();break;case el.type:case ed.type:this.__onPositionUpdated();break;case tZ.type:t.containsOptions("fisheye")&&this.__onPositionUpdated(),t.containsOptions("canvasBackground")&&(this.renderer.domElement.style.background=this.config.canvasBackground)}}hide(){this.container.style.opacity="0"}show(){this.container.style.opacity="1"}setCustomRenderer(t){t?this.customRenderer=t(this.renderer):this.customRenderer=null,this.viewer.needsUpdate()}__onSizeUpdated(){this.renderer.setSize(this.state.size.width,this.state.size.height),this.camera.aspect=this.state.aspect,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onZoomUpdated(){this.camera.fov=this.state.vFov,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onPositionUpdated(){this.camera.position.set(0,0,0),this.camera.lookAt(this.state.direction),this.config.fisheye&&this.camera.position.copy(this.state.direction).multiplyScalar(this.config.fisheye/2).negate(),this.camera.rotateZ(-this.state.roll),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__renderLoop(t){let e=this.timestamp?t-this.timestamp:0;this.timestamp=t,this.viewer.dispatchEvent(new tF(t,e)),this.viewer.dynamics.update(e),(this.state.needsUpdate||this.state.continuousUpdateCount>0)&&(this.state.needsUpdate=!1,(this.customRenderer||this.renderer).render(this.scene,this.camera),this.viewer.dispatchEvent(new em))}setTexture(t){this.meshContainer||(this.meshContainer=new o.YJl,this.scene.add(this.meshContainer)),this.state.textureData&&this.viewer.adapter.disposeTexture(this.state.textureData),this.mesh&&(this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh)),this.mesh=this.viewer.adapter.createMesh(t.panoData),this.viewer.adapter.setTexture(this.mesh,t,!1),this.meshContainer.add(this.mesh),this.state.textureData=t,this.viewer.needsUpdate()}setPanoramaPose(t,e=this.mesh){let i=this.viewer.dataHelper.cleanPanoramaPose(t);e.rotation.set(i.tilt,i.pan,i.roll,"YXZ")}setSphereCorrection(t,e=this.meshContainer){let i=this.viewer.dataHelper.cleanSphereCorrection(t);e.rotation.set(i.tilt,i.pan,i.roll,"YXZ")}transition(t,e,i){let s="fade"===i.effect||i.rotation,n=!Q(e.position),a=!Q(e.zoom),r=new tj(n?this.viewer.dataHelper.cleanPosition(e.position):void 0,e.zoom);this.viewer.dispatchEvent(r);let h=new o.YJl,l=this.viewer.adapter.createMesh(t.panoData);if(this.viewer.adapter.setTexture(l,t,!0),this.viewer.adapter.setTextureOpacity(l,0),this.setPanoramaPose(t.panoData,l),this.setSphereCorrection(e.sphereCorrection,h),n&&!i.rotation){let t=this.viewer.getPosition(),e=new o.Pq0(0,1,0);h.rotateOnWorldAxis(e,r.position.yaw-t.yaw);let i=new o.Pq0(0,1,0).cross(this.camera.getWorldDirection(new o.Pq0)).normalize();h.rotateOnWorldAxis(i,r.position.pitch-t.pitch)}h.add(l),this.scene.add(h),this.renderer.setRenderTarget(new o.nWS),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(null);let{duration:c,properties:d}=this.viewer.dataHelper.getAnimationProperties(i.speed,i.rotation?r.position:null,s?r.zoomLevel:null),u=new tP({properties:{...d,opacity:{start:0,end:1}},duration:c,easing:"inOutCubic",onTick:t=>{switch(i.effect){case"fade":this.viewer.adapter.setTextureOpacity(l,t.opacity);break;case"black":case"white":t.opacity<.5?this.renderer.toneMappingExposure="black"===i.effect?o.cj9.mapLinear(t.opacity,0,.5,1,0):o.cj9.mapLinear(t.opacity,0,.5,1,5):(this.renderer.toneMappingExposure="black"===i.effect?o.cj9.mapLinear(t.opacity,.5,1,0,1):o.cj9.mapLinear(t.opacity,.5,1,5,1),this.mesh.visible=!1,this.viewer.adapter.setTextureOpacity(l,1),a&&!s&&this.viewer.dynamics.zoom.setValue(r.zoomLevel))}n&&i.rotation&&this.viewer.dynamics.position.setValue({yaw:t.yaw,pitch:t.pitch}),a&&s&&this.viewer.dynamics.zoom.setValue(t.zoom),this.viewer.needsUpdate()}});return u.then(s=>{h.remove(l),this.scene.remove(h),s?(this.viewer.adapter.disposeTexture(this.state.textureData),this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh),this.mesh=l,this.meshContainer.add(l),this.state.textureData=t,this.setPanoramaPose(t.panoData),this.setSphereCorrection(e.sphereCorrection),n&&!i.rotation&&this.viewer.rotate(e.position)):(this.viewer.adapter.disposeTexture(t),this.viewer.adapter.disposeMesh(l))}),u}getIntersections(t){ix.x=2*t.x/this.state.size.width-1,ix.y=-2*t.y/this.state.size.height+1,this.raycaster.setFromCamera(ix,this.camera);let e=this.raycaster.intersectObjects(this.scene.children,!0).filter(t=>t.object.visible).filter(t=>t.object.isMesh&&!!t.object.userData);return this.customRenderer?.getIntersections&&e.push(...this.customRenderer.getIntersections(this.raycaster,ix)),e}isObjectVisible(t){return!!t&&((this.frustumNeedsUpdate&&(iL.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),this.frustum.setFromProjectionMatrix(iL),this.frustumNeedsUpdate=!1),t.isVector3)?this.frustum.containsPoint(t):t.isMesh&&t.geometry?(t.geometry.boundingBox||t.geometry.computeBoundingBox(),iC.copy(t.geometry.boundingBox).applyMatrix4(t.matrixWorld),this.frustum.intersectsBox(iC)):!!t.isObject3D&&this.frustum.intersectsObject(t))}addObject(t){this.scene.add(t)}removeObject(t){this.scene.remove(t)}cleanScene(t){let e=t=>{t.map?.dispose(),t.uniforms&&Object.values(t.uniforms).forEach(t=>{t.value?.dispose?.()}),t.dispose()};t.traverse(i=>{i.geometry?.dispose(),i.material&&(Array.isArray(i.material)?i.material.forEach(t=>{e(t)}):e(i.material)),i instanceof o.Z58||i.dispose?.(),i!==t&&this.cleanScene(i)})}},iO=class extends o.$NF{constructor(){super(...arguments),this._abortController=new AbortController}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}load(t,e,i,s){let o=this._abortController.signal,n=super.load(t,t=>{r(),e(t)},i,t=>{if(r(),o.aborted){let t=Error();t.name="AbortError",t.message="The operation was aborted.",s(t)}else s(t)});function a(){n.src=""}function r(){o.removeEventListener("abort",a,!1)}return o.addEventListener("abort",a,!1),n}},ik=class extends iy{constructor(t){super(t),this.fileLoader=new o.Y9S,this.fileLoader.setResponseType("blob"),this.imageLoader=new iO}destroy(){this.abortLoading(),super.destroy()}abortLoading(){this.fileLoader.abort?.(),this.imageLoader.abort()}loadFile(t,e,i){let s=id.get(t,i);if(s)if(s instanceof Blob)return e?.(100),Promise.resolve(s);else id.remove(t,i);this.config.requestHeaders&&this.fileLoader.setRequestHeader(this.config.requestHeaders(t)),this.fileLoader.setWithCredentials(this.config.withCredentials(t));let o=0;return e?.(o),this.fileLoader.loadAsync(t,t=>{if(t.lengthComputable){let i=t.loaded/t.total*100;i>o&&(o=i,e?.(o))}}).then(s=>(o=100,e?.(o),id.add(t,i,s),s))}loadImage(t,e,i){let s=id.get(t,i);return s?(e?.(100),s instanceof Blob)?this.blobToImage(s):Promise.resolve(s):e||this.config.requestHeaders?this.loadFile(t,e,i).then(t=>this.blobToImage(t)):(this.imageLoader.setWithCredentials(this.config.withCredentials(t)),this.imageLoader.loadAsync(t).then(e=>(id.add(t,i,e),e)))}blobToImage(t){return new Promise((e,i)=>{let s=document.createElement("img");s.onload=()=>{URL.revokeObjectURL(s.src),e(s)},s.onerror=i,s.src=URL.createObjectURL(t)})}preloadPanorama(t){return this.viewer.adapter.supportsPreload(t)?this.viewer.adapter.loadTexture(t,!1):Promise.reject(new te("Current adapter does not support preload"))}dispatchProgress(t){this.viewer.loader.setProgress(t),this.viewer.dispatchEvent(new t9(Math.round(t)))}},iI=class extends iy{constructor(t){super(t),this.zoom=new tO(t=>{this.viewer.state.vFov=this.viewer.dataHelper.zoomLevelToFov(t),this.viewer.state.hFov=this.viewer.dataHelper.vFovToHFov(this.viewer.state.vFov),this.viewer.dispatchEvent(new eO(t))},{defaultValue:this.viewer.config.defaultZoomLvl,min:0,max:100,wrap:!1}),this.position=new tk(t=>{this.viewer.dataHelper.sphericalCoordsToVector3(t,this.viewer.state.direction),this.viewer.dispatchEvent(new el(t))},{yaw:new tO(null,{defaultValue:this.config.defaultYaw,min:0,max:2*Math.PI,wrap:!0}),pitch:new tO(null,{defaultValue:this.config.defaultPitch,min:-Math.PI/2,max:Math.PI/2,wrap:!1})}),this.roll=new tO(t=>{this.viewer.state.roll=t,this.viewer.dispatchEvent(new ed(t))},{defaultValue:0,min:-Math.PI,max:Math.PI,wrap:!1}),this.updateSpeeds()}updateSpeeds(){this.zoom.setSpeed(50*this.config.zoomSpeed),this.position.setSpeed(o.cj9.degToRad(50*this.config.moveSpeed)),this.roll.setSpeed(o.cj9.degToRad(50*this.config.moveSpeed))}update(t){this.zoom.update(t),this.position.update(t),this.roll.update(t)}},iS=class{constructor(){this.ready=!1,this.needsUpdate=!1,this.continuousUpdateCount=0,this.keyboardEnabled=!1,this.direction=new o.Pq0(0,0,m),this.roll=0,this.vFov=60,this.hFov=60,this.aspect=1,this.animation=null,this.transitionAnimation=null,this.loadingPromise=null,this.idleTime=-1,this.objectsObservers={},this.size={width:0,height:0}}},iz=class extends tA{constructor(t){if(super(),this.plugins={},this.children=[],this.parent=I(t.container),!this.parent)throw new te('"container" element not found.');this.parent[w]=this,this.container=document.createElement("div"),this.container.classList.add("psv-container"),this.parent.appendChild(this.container),tL(this.parent),tM(this.container,"core"),this.state=new iS,this.config=io(t),this.__setSize(this.config.size),this.overlay=new iv(this);try{eV.load()}catch(t){console.error(t),this.showError(this.config.lang.webglError);return}for(let t of(id.init(),this.adapter=new this.config.adapter[0](this,this.config.adapter[1]),this.renderer=new iP(this),this.textureLoader=new ik(this),this.eventsHandler=new iM(this),this.dataHelper=new i_(this),this.dynamics=new iI(this),this.adapter.init?.(),this.loader=new iu(this),this.navbar=new ic(this),this.panel=new iw(this),this.notification=new ip(this),this.autoSize(),this.setCursor(null),ti(eV.isTouchEnabled,t=>{S(this.container,"psv--is-touch",t)}),this.config.plugins.forEach(([t,e])=>{this.plugins[t.id]=new t(this,e)}),Object.values(this.plugins)))t.init?.();this.config.navbar&&this.navbar.setButtons(this.config.navbar),this.state.loadingPromise||(this.config.panorama?this.setPanorama(this.config.panorama,{sphereCorrection:this.config.sphereCorrection,panoData:this.config.panoData}):this.loader.show())}destroy(){for(let[t,e]of(this.stopAll(),this.stopKeyboardControl(),this.exitFullscreen(),Object.entries(this.plugins)))e.destroy(),delete this.plugins[t];this.children.slice().forEach(t=>t.destroy()),this.children.length=0,this.eventsHandler?.destroy(),this.renderer?.destroy(),this.textureLoader?.destroy(),this.dataHelper?.destroy(),this.adapter?.destroy(),this.dynamics?.destroy(),this.parent.removeChild(this.container),delete this.parent[w]}init(){this.eventsHandler.init(),this.renderer.init(),this.config.navbar&&this.navbar.show(),"always"===this.config.keyboard&&this.startKeyboardControl(),this.resetIdleTimer(),this.state.ready=!0,this.dispatchEvent(new ep)}resetIdleTimer(){this.state.idleTime=performance.now()}disableIdleTimer(){this.state.idleTime=-1}getPlugin(t){if("string"==typeof t)return this.plugins[t];{let e=it(t);return e?this.plugins[e.id]:null}}getPosition(){return this.dataHelper.cleanPosition(this.dynamics.position.current)}getZoomLevel(){return this.dynamics.zoom.current}getSize(){return{...this.state.size}}isFullscreenEnabled(){return U(this.parent,eV.isIphone)}needsUpdate(){this.state.needsUpdate=!0}needsContinuousUpdate(t){t?this.state.continuousUpdateCount++:this.state.continuousUpdateCount>0&&this.state.continuousUpdateCount--}autoSize(){(this.container.clientWidth!==this.state.size.width||this.container.clientHeight!==this.state.size.height)&&(this.state.size.width=Math.round(this.container.clientWidth),this.state.size.height=Math.round(this.container.clientHeight),this.state.aspect=this.state.size.width/this.state.size.height,this.state.hFov=this.dataHelper.vFovToHFov(this.state.vFov),this.dispatchEvent(new ex(this.getSize())),this.navbar.autoSize())}setPanorama(t,e={}){this.textureLoader.abortLoading(),this.state.transitionAnimation?.cancel();let i=this.dataHelper.getTransitionOptions(e);void 0===e.showLoader&&(e.showLoader=!0),void 0===e.caption&&(e.caption=this.config.caption),void 0===e.description&&(e.description=this.config.description),e.panoData||"function"!=typeof this.config.panoData||(e.panoData=this.config.panoData),this.hideError(),this.resetIdleTimer(),this.config.panorama=t,this.config.caption=e.caption,this.config.description=e.description,this.config.sphereCorrection=e.sphereCorrection,("function"!=typeof this.config.panoData||"function"==typeof e.panoData)&&(this.config.panoData=e.panoData);let s=e=>{if(tn(e))return!1;if(this.loader.hide(),this.state.loadingPromise=null,!e)return this.navbar.setCaption(this.config.caption),!0;throw this.navbar.setCaption(null),this.showError(this.config.lang.loadError),console.error(e),this.dispatchEvent(new en(t,e)),e};this.navbar.setCaption(`<em>${this.config.lang.loading}</em>`),(e.showLoader||!this.state.ready)&&this.loader.show(),this.dispatchEvent(new ee(t));let o=this.adapter.loadTexture(this.config.panorama,!0,e.panoData).then(t=>{if(t.panorama!==this.config.panorama)throw this.adapter.disposeTexture(t),to();let i=this.dataHelper.cleanPanoramaOptions(e,t.panoData);return Q(i.zoom)&&Q(i.position)||this.stopAll(),{textureData:t,cleanOptions:i}});return i&&this.state.ready&&this.adapter.supportsTransition(this.config.panorama)?this.state.loadingPromise=o.then(({textureData:t,cleanOptions:e})=>(this.loader.hide(),this.dispatchEvent(new es(t)),this.state.transitionAnimation=this.renderer.transition(t,e,i),this.state.transitionAnimation)).then(t=>{if(this.state.transitionAnimation=null,this.dispatchEvent(new er(t)),!t)throw to()}).then(()=>s(),t=>s(t)):this.state.loadingPromise=o.then(({textureData:t,cleanOptions:i})=>{this.renderer.show(),this.renderer.setTexture(t),this.renderer.setPanoramaPose(t.panoData),this.renderer.setSphereCorrection(e.sphereCorrection),this.state.ready||this.init(),this.dispatchEvent(new es(t)),Q(i.zoom)||this.zoom(i.zoom),Q(i.position)||this.rotate(i.position)}).then(()=>s(),t=>s(t)),this.state.loadingPromise}setOptions(t){let e={...this.config,...t};for(let[i,s]of Object.entries(t)){if(!(i in ie)){ta(`Unknown option ${i}`);continue}if(i in ii){ta(ii[i]);continue}switch(i in is&&(s=is[i](s,{rawConfig:e,defValue:ie[i]})),this.config[i]=s,i){case"mousemove":this.state.cursorOverride||this.setCursor(null);break;case"caption":this.navbar.setCaption(this.config.caption);break;case"size":this.resize(this.config.size);break;case"sphereCorrection":this.renderer.setSphereCorrection(this.config.sphereCorrection);break;case"navbar":case"lang":this.navbar.setButtons(this.config.navbar);break;case"moveSpeed":case"zoomSpeed":this.dynamics.updateSpeeds();break;case"minFov":case"maxFov":this.dynamics.zoom.setValue(this.dataHelper.fovToZoomLevel(this.state.vFov)),this.dispatchEvent(new eO(this.getZoomLevel()));break;case"keyboard":"always"===this.config.keyboard?this.startKeyboardControl():this.stopKeyboardControl()}}this.needsUpdate(),this.dispatchEvent(new tZ(Object.keys(t)))}setOption(t,e){this.setOptions({[t]:e})}showError(t){this.overlay.show({id:y.ERROR,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="15 15 70 70"><path fill="currentColor" d="M50,16.2c-18.6,0-33.8,15.1-33.8,33.8S31.4,83.7,50,83.7S83.8,68.6,83.8,50S68.6,16.2,50,16.2z M50,80.2c-16.7,0-30.2-13.6-30.2-30.2S33.3,19.7,50,19.7S80.3,33.3,80.3,50S66.7,80.2,50,80.2z"/><rect fill="currentColor" x="48" y="31.7" width="4" height="28"/><rect fill="currentColor" x="48" y="63.2" width="4" height="5"/>\x3c!--Created by Shastry from the Noun Project--\x3e</svg>\n',title:t,dismissible:!1})}hideError(){this.overlay.hide(y.ERROR)}rotate(t){let e=new tW(this.dataHelper.cleanPosition(t));this.dispatchEvent(e),e.defaultPrevented||this.dynamics.position.setValue(e.position)}zoom(t){this.dynamics.zoom.setValue(t)}zoomIn(t=1){this.dynamics.zoom.step(t)}zoomOut(t=1){this.dynamics.zoom.step(-t)}animate(t){let e=tr(t),i=!Q(t.zoom),s=new tj(e?this.dataHelper.cleanPosition(t):void 0,t.zoom);if(this.dispatchEvent(s),s.defaultPrevented)return;this.stopAll();let{duration:o,properties:n}=this.dataHelper.getAnimationProperties(t.speed,s.position,s.zoomLevel);return o?(this.state.animation=new tP({properties:n,duration:o,easing:t.easing||"inOutSine",onTick:t=>{e&&this.dynamics.position.setValue({yaw:t.yaw,pitch:t.pitch}),i&&this.dynamics.zoom.setValue(t.zoom)}}),this.state.animation.then(()=>{this.state.animation=null,this.resetIdleTimer()}),this.state.animation):(e&&this.rotate(s.position),i&&this.zoom(s.zoomLevel),new tP(null))}stopAnimation(){return this.state.animation?(this.state.animation.cancel(),this.state.animation):Promise.resolve()}resize(t){this.__setSize(t),this.autoSize()}__setSize(t){["width","height"].forEach(e=>{t?.[e]&&(/^[0-9.]+$/.test(t[e])&&(t[e]+="px"),this.parent.style[e]=t[e])})}enterFullscreen(){this.isFullscreenEnabled()||W(this.parent,eV.isIphone)}exitFullscreen(){this.isFullscreenEnabled()&&Y(eV.isIphone)}toggleFullscreen(){this.isFullscreenEnabled()?this.exitFullscreen():this.enterFullscreen()}startKeyboardControl(){this.state.keyboardEnabled=!0}stopKeyboardControl(){this.state.keyboardEnabled=!1}createTooltip(t){return new ig(this,t)}setCursor(t){this.state.cursorOverride=t,t?this.container.style.cursor=t:this.container.style.cursor=this.config.mousemove?"move":"default"}observeObjects(t){this.state.objectsObservers[t]||(this.state.objectsObservers[t]=null)}unobserveObjects(t){delete this.state.objectsObservers[t]}stopAll(){return this.dispatchEvent(new eC),this.disableIdleTimer(),this.stopAnimation()}}}}]);