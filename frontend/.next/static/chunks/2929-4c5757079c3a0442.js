"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2929],{15340:(e,t,a)=>{a.d(t,{A:()=>v});var s=a(95155),r=a(12115),l=a(42196),i=a(89715),n=a(60890),d=a(43586),o=a(1375),c=a(92001),u=a(65229),m=a(26983),x=a(21786),h=a(42529),p=a(6132),g=a(71360),f=a(18085);function v(e){let{isOpen:t,onClose:a,tugasId:v,tugasTitle:b,deadline:j,onUploadComplete:y}=e,[N,w]=(0,r.useState)([]),[k,A]=(0,r.useState)(!1),[C,D]=(0,r.useState)(!1),[M,z]=(0,r.useState)(""),W=(0,r.useRef)(null),B=e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},F=e=>e.type.startsWith("image/")?"image":e.type.startsWith("video/")?"video":e.type.startsWith("audio/")?"audio":e.type.includes("zip")||e.type.includes("rar")?"archive":e.type.includes("pdf")||e.type.includes("document")||e.type.includes("text")?"document":"other",T=e=>new Promise(t=>{if(e.type.startsWith("image/")){let a=new FileReader;a.onload=e=>{var a;return t(null==(a=e.target)?void 0:a.result)},a.readAsDataURL(e)}else t(void 0)}),S=e=>e.size>0x3200000?{valid:!1,error:"File terlalu besar. Maksimal 50MB"}:["image/*","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain","video/*","audio/*","application/zip","application/x-rar-compressed"].some(t=>t.endsWith("/*")?e.type.startsWith(t.slice(0,-1)):e.type===t)?{valid:!0}:{valid:!1,error:"Tipe file tidak didukung"},U=(0,r.useCallback)(async e=>{let t=[],a=[];for(let s=0;s<e.length;s++){let r=e[s],l=S(r);if(!l.valid){a.push("".concat(r.name,": ").concat(l.error));continue}if(N.length+t.length>=10){a.push("Maksimal 10 file");break}let i=F(r),n=await T(r);t.push({id:"".concat(Date.now(),"-").concat(Math.random()),file:r,preview:n,type:i,size:B(r.size),status:"pending"})}a.length>0&&alert(a.join("\n")),t.length>0&&w(e=>[...e,...t])},[N]),_=async e=>new Promise(t=>{let a=0,s=setInterval(()=>{(a+=30*Math.random())>=100&&(a=100,clearInterval(s),t()),w(t=>t.map(t=>t.id===e.id?{...t,progress:a,status:100===a?"completed":"uploading"}:t))},200)}),I=async()=>{if(0===N.length)return void alert("Pilih file terlebih dahulu");D(!0);try{for(let e of N)await _(e);null==y||y(N),w([]),z(""),a()}catch(e){console.error("Upload error:",e),alert("Terjadi kesalahan saat upload")}finally{D(!1)}};return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[(0,s.jsxs)("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-bold",children:"Upload Tugas"}),(0,s.jsx)("p",{className:"text-orange-100 text-sm mt-1",children:b})]}),(0,s.jsx)("button",{onClick:a,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:(0,s.jsx)(u.A,{className:"w-5 h-5"})})]}),(0,s.jsxs)("div",{className:"mt-4 flex items-center gap-2 text-orange-100 text-sm",children:[(0,s.jsx)(m.A,{className:"w-4 h-4"}),(0,s.jsxs)("span",{children:["Deadline: ",new Date(j).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]}),(0,s.jsxs)("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-200px)]",children:[(0,s.jsxs)("div",{className:"relative border-2 border-dashed rounded-xl p-8 text-center transition-all duration-300 ".concat(k?"border-orange-400 bg-orange-50 scale-[1.02]":"border-gray-300 hover:border-orange-300 hover:bg-orange-50/30"),onDragOver:e=>{e.preventDefault(),A(!0)},onDragLeave:e=>{e.preventDefault(),A(!1)},onDrop:e=>{e.preventDefault(),A(!1);let t=e.dataTransfer.files;t.length>0&&U(t)},onClick:()=>{W.current&&W.current.click()},children:[(0,s.jsx)("input",{ref:W,type:"file",multiple:!0,accept:"image/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain,video/*,audio/*,application/zip,application/x-rar-compressed",onChange:e=>{let t=e.target.files;t&&t.length>0&&U(t),W.current&&(W.current.value="")},className:"hidden"}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)("div",{className:"p-4 rounded-full transition-colors ".concat(k?"bg-orange-100":"bg-gray-100"),children:(0,s.jsx)(x.A,{className:"w-8 h-8 ".concat(k?"text-orange-600":"text-gray-600")})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:k?"Lepaskan file di sini":"Upload File Tugas"}),(0,s.jsx)("p",{className:"text-gray-600 text-sm mb-2",children:"Drag & drop file atau klik untuk memilih"}),(0,s.jsx)("p",{className:"text-gray-500 text-xs",children:"Maksimal 10 file, 50MB per file"})]})]})]}),N.length>0&&(0,s.jsxs)("div",{className:"mt-6 space-y-3",children:[(0,s.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:[(0,s.jsx)(c.A,{className:"w-4 h-4"}),"File Terpilih (",N.length,")"]}),(0,s.jsx)("div",{className:"space-y-2",children:N.map(e=>{var t;let a=(t=e.file.type).startsWith("image/")?l.A:t.includes("pdf")||t.includes("document")?i.A:t.startsWith("video/")?n.A:t.startsWith("audio/")?d.A:t.includes("zip")||t.includes("rar")?o.A:c.A;return(0,s.jsx)("div",{className:"bg-white border rounded-xl p-4 transition-all duration-200 ".concat("completed"===e.status?"border-green-200 bg-green-50":"error"===e.status?"border-red-200 bg-red-50":"border-gray-200 hover:shadow-md"),children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center ".concat("completed"===e.status?"bg-green-100":"error"===e.status?"bg-red-100":"bg-gray-100"),children:(0,s.jsx)(a,{className:"w-5 h-5 ".concat("completed"===e.status?"text-green-600":"error"===e.status?"text-red-600":"text-gray-600")})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-800 truncate",children:e.file.name}),"completed"===e.status&&(0,s.jsx)(h.A,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),"error"===e.status&&(0,s.jsx)(p.A,{className:"w-4 h-4 text-red-500 flex-shrink-0"})]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:[e.size," â€¢ ",e.type]}),"uploading"===e.status&&void 0!==e.progress&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,s.jsx)("div",{className:"bg-orange-500 h-1.5 rounded-full transition-all duration-300",style:{width:"".concat(e.progress,"%")}})}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[e.progress,"%"]})]})]}),e.preview&&(0,s.jsx)("button",{className:"text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded-md hover:bg-blue-200 transition-colors",onClick:()=>window.open(e.preview,"_blank"),children:"Preview"}),(0,s.jsx)("button",{onClick:()=>{var t;return t=e.id,void w(e=>e.filter(e=>e.id!==t))},className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",disabled:"uploading"===e.status,children:(0,s.jsx)(g.A,{className:"w-4 h-4"})})]})},e.id)})})]}),(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Komentar (Opsional)"}),(0,s.jsx)("textarea",{value:M,onChange:e=>z(e.target.value),placeholder:"Tambahkan komentar untuk tugas Anda...",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none",rows:3})]})]}),(0,s.jsxs)("div",{className:"bg-gray-50 px-6 py-4 flex justify-end gap-3",children:[(0,s.jsx)("button",{onClick:a,className:"px-6 py-2 border border-gray-300 text-gray-600 rounded-xl font-medium hover:bg-gray-50 transition-colors",disabled:C,children:"Batal"}),(0,s.jsx)("button",{onClick:I,disabled:0===N.length||C,className:"px-6 py-2 bg-orange-500 text-white rounded-xl font-medium hover:bg-orange-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:C?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Uploading..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.A,{className:"w-4 h-4"}),"Kirim Tugas"]})})]})]})}):null}},60230:(e,t,a)=>{a.d(t,{A:()=>i,i:()=>l});var s=a(12115);let r=(0,s.createContext)({user:null,student:null,teacher:null,students:null,teachers:null,tugas:null,subjects:null,exams:null,nilai:null,schedules:null,rooms:null,classes:null}),l=()=>(0,s.useContext)(r),i=r}}]);